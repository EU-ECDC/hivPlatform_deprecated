(()=>{"use strict";var e={9606:(e,t,a)=>{var r=a(4741),n=a(9191),i=a(2230);const s=jQuery;var l=a.n(s),o=a(4692),m=a(2212),c=a(4890),d=a(9896),u=a(1488),g=a(1222),p=a(4031),h=a(1954),E=a(7142),y=a(3291),M=a(4589),f=a(3205),v=a(1772),b=a(2488),D=a(7246),S=a(383),Z=a(4153);const x=(0,i.Pi)((e=>{var{pages:t,activePageId:a,onPageChange:n}=e;return r.createElement("div",{style:{minWidth:250,backgroundColor:"white"}},r.createElement(M.Z,{nonLinear:!0,activeStep:a,orientation:"vertical"},t.map(((e,t)=>r.createElement(f.Z,{key:t,completed:e.completed,disabled:e.disabled},r.createElement(v.Z,{onClick:()=>n(t)},r.createElement(b.Z,null,e.title)),e.subPages&&r.createElement(Z.Z,null,r.createElement(D.Z,null,e.subPages.map(((a,i)=>r.createElement(S.Z,{button:!0,key:i,selected:i===e.activeSubPageId,disabled:a.disabled,onClick:()=>n(t,i)},a.title))))))))))}));var C=a(9202),P=a(2525);const I=e=>{var{appMgr:t,open:a,onClose:n}=e,i=["downState"];return r.useEffect((()=>(t.unbindShiny(i),t.bindShiny(),()=>t.unbindShiny(i)))),r.createElement(C.ZP,{anchor:"right",open:a,onClose:n},r.createElement(h.Z,{width:300,p:2},r.createElement(p.Z,{variant:"h6"},"Application"),r.createElement(P.Z,{href:"#",id:"downState",className:"shiny-download-link"},"Save state"),r.createElement(P.Z,{href:"#",style:{marginLeft:10}},"Load state")))};var A=a(2899),F=a(1785),N=a(7460),R=a(5699),T=a(6360),j=a(299),w=a(3570),Y=a(4664),O=e=>{var{title:t,description:a,moreText:n,image:i,onClick:s}=e,[l,o]=r.useState(!1);return r.createElement(F.Z,null,r.createElement(N.Z,{onClick:s},r.createElement(T.Z,{style:{height:300},image:i}),r.createElement(R.Z,null,r.createElement(p.Z,{gutterBottom:!0,variant:"h5",component:"h2"},t),r.createElement(p.Z,{variant:"body2",color:"textSecondary",component:"p"},a))),r.createElement(j.Z,{disableSpacing:!0},r.createElement(Y.Z,{onClick:()=>o(!l),size:"small",color:"primary"},l?"Read less...":"Read more...")),r.createElement(w.Z,{in:l,timeout:"auto",unmountOnExit:!0},r.createElement(R.Z,null,n)))};const k=e=>{var t=e.appMgr,a=()=>t.uiStateMgr.setActivePageId(1),n=r.createElement(r.Fragment,null,r.createElement("p",null,"The ",r.createElement("b",null,"HIV Estimates Accuracy Tool")," is an application that uses statistical methods to calculate adjusted estimates from HIV surveillance data."),r.createElement("p",null,"Missing data are a well-recognised problem within surveillance systems. When values for some variables are missing and cases with missing values are excluded from analysis, it may lead to biased and potentially less precise estimates. Reporting delay, the time from case diagnosis to notification, can lead to problems when analysing the most recent years given that information on certain cases or variables may not have been collected yet due to national reporting process characteristics."),r.createElement("p",null,"With this tool you can correct missing data for the variables age, gender, transmission category and CD4 count. Additionally, the tool allows for correction of delays in reporting. The adjustments may be used separately or in combination."),r.createElement("p",null,"The tool accepts HIV case-based surveillance data and requires a minimum set of variables routinely collected at national public health systems."),r.createElement("p",null,"A complete instruction ",r.createElement("a",{href:"#"},"manual")," will guide you through the tool. The manual can also be consulted to interpret the outputs. The outputs include results in the form of a report containing tables and graphs, and datasets in various file formats, in which the corrections have been incorporated and are ready for further analysis.")),i=r.createElement(r.Fragment,null,r.createElement("p",null,"The ",r.createElement("b",null,"HIV Modelling Tool")," is an application that can estimate How many people are getting infected with HIV, how many are being missed or not being reported and how many should be on treatment."),r.createElement("p",null,"The tool uses CD4 back calculation methods to estimate the number of people living with HIV, including those not yet diagnosed. The tool can also estimate the annual number of new HIV infections, the average time between infection and diagnosis, and the number of undiagnosed people CD4 category."),r.createElement("p",null,"The tool accepts a minimum required set of variables: HIV cases, AIDS cases and HIVAIDS cases and, if available, CD4 count at HIV diagnosis. The tool uses aggregated HIV surveillance data or case-based data. Data adjusted by the Accuracy tool can thereafter be used as input data for this tool. When data on these parameters are provided, the tool also accounts for mortality and migration."),r.createElement("p",null,"A complete instruction manual will guide you through the tool. The ",r.createElement("a",{href:"#"},"manual")," can also be consulted to interpret the outputs and to aid in the selection of some parameters using clear and well instructed examples.")),s=r.createElement(r.Fragment,null,r.createElement("p",null,"The two tools were combined into one flexible tool that manages all inputs, adjustments and outputs in one simple workflow. After uploading HIV cased-based data, the data can be initially adjusted for missing information and/or reporting delay and then automatically used as input data to the modelling tool, where estimates of HIV incidence, prevalence and the undiagnosed number of people living with HIV can be made."));return r.createElement(A.Z,{container:!0,direction:"row",justify:"space-evenly",alignItems:"baseline"},r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{width:"50%",m:"auto",p:5},r.createElement("p",null,"HIV continues to be of significant public health importance in the European Union as well as globally. To evaluate and direct prevention efforts, it is crucial to understand the pattern of new HIV infections, or HIV incidence, among groups most at risk of infection. It is also important to estimate the size of the total population of persons living with HIV, including those that are not yet diagnosed, in order to understand the burden of HIV and the need for antiretroviral treatment and other HIV-related care. Accurate surveillance data are crucial to achieve reliable parameter estimates."),r.createElement("p",null,"The ECDC HIV Modelling Platform provides a set of tools to support users to obtain reliable parameter estimates to appropriately direct and evaluate public health responses."))),r.createElement(A.Z,{item:!0,xs:3},r.createElement(O,{title:"Accuracy",description:"Adjust case-based data for missing values and reporting delay",moreText:n,image:"www/img/accuracy.png",onClick:a})),r.createElement(A.Z,{item:!0,xs:3},r.createElement(O,{title:"Modelling",description:"Estimate number of PLHIV and incidence",moreText:i,image:"www/img/modelling.png",onClick:a})),r.createElement(A.Z,{item:!0,xs:3},r.createElement(O,{title:"All-in-one",description:"Accuracy adjustements and modelling integrated in one tool",moreText:s,image:"www/img/all-in-one.png",onClick:a})))};var L=a(7012);function B(){return(B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}const W=e=>{var{children:t}=e,a=function(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}(e,["children"]);return r.createElement(p.Z,B({component:"div",role:"tabpanel",style:{flexGrow:1}},a),t)};var G=a(4411),V=a(8095),U=a(5826),z=a(9672),H=a(6054),_=a(2319),Q=a(2350);function J(){return(J=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var q=(0,d.Z)((()=>({root:{color:"white"}})));const K=e=>{var t=q(),{children:a}=e,n=function(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}(e,["children"]);return r.createElement(Y.Z,J({variant:"contained",color:"primary",component:"span",className:t.root},n),a)};var X=a(2189);const ee=e=>null==e;var te=(0,d.Z)((()=>({root:{marginTop:10,marginBottom:10,height:10}})));const ae=e=>{var{progress:t}=e;if(ee(t))return null;var a=te();return r.createElement(X.Z,{variant:"determinate",value:100*t,color:"secondary",className:a.root})};var re=a(1284);function ne(){return(ne=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}const ie=e=>{var{valid:t,msg:a}=e,n=function(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}(e,["valid","msg"]);if(ee(t))return null;var i=t?"success":"error";return r.createElement(re.Z,ne({severity:i},n,{style:{marginTop:10}}),a)},se=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(ee(e))return"";if(0===e)return"0 Bytes";var a=1024,r=t<0?0:t,n=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(a));return parseFloat((e/Math.pow(a,i)).toFixed(r))+" "+n[i]};var le=(0,d.Z)({header:{width:142,fontWeight:"bold"},content:{maxWidth:0,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}});const oe=(0,i.Pi)((e=>{var{appMgr:t}=e,a=le();return r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{display:"flex",justifyContent:"flex-end"},r.createElement(Y.Z,{size:"small",color:"primary",disabled:!t.uiStateMgr.summaryPageEnabled,onClick:e=>t.uiStateMgr.setActivePageId(2)},"Next step"))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(p.Z,{variant:"h6"},"Upload case-based data")),r.createElement(A.Z,{item:!0,xs:2},r.createElement("input",{style:{display:"none"},id:"caseUploadBtn",className:"uploadBtn",type:"file",onChange:e=>t.caseBasedDataMgr.uploadData(e.target)}),r.createElement(G.ZP,{title:"Select case-based data file"},r.createElement("label",{htmlFor:"caseUploadBtn"},r.createElement(K,{style:{marginBottom:6}},r.createElement(Q.Z,null)," Upload data"))),r.createElement(p.Z,{variant:"body2",color:"textSecondary"},"Maximum file size: 100MB",r.createElement("br",null),"Supported files types: rds, txt, csv, xls, xlsx (uncompressed and zip archives)"),r.createElement(ae,{progress:t.caseBasedDataMgr.uploadProgress}),r.createElement(ie,{valid:t.caseBasedDataMgr.actionValid,msg:t.caseBasedDataMgr.actionMessage})),r.createElement(A.Z,{item:!0,xs:10},t.caseBasedDataMgr.actionValid&&r.createElement(_.Z,{style:{padding:10}},r.createElement(p.Z,{variant:"overline"},"Uploaded file details"),r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:6},r.createElement(V.Z,null,r.createElement(U.Z,null,r.createElement(H.Z,{hover:!0},r.createElement(z.Z,{className:a.header},"File name"),r.createElement(z.Z,{className:a.content},t.caseBasedDataMgr.fileName)),r.createElement(H.Z,{hover:!0},r.createElement(z.Z,{className:a.header},"File path"),r.createElement(z.Z,{className:a.content},t.caseBasedDataMgr.filePath)),r.createElement(H.Z,{hover:!0},r.createElement(z.Z,{className:a.header},"File size"),r.createElement(z.Z,{className:a.content},se(t.caseBasedDataMgr.fileSize))),r.createElement(H.Z,{hover:!0},r.createElement(z.Z,{className:a.header},"File type"),r.createElement(z.Z,{className:a.content},t.caseBasedDataMgr.fileType)),r.createElement(H.Z,{hover:!0},r.createElement(z.Z,{className:a.header},"Number of records"),r.createElement(z.Z,{className:a.content},t.caseBasedDataMgr.recordCount))))),r.createElement(A.Z,{item:!0,xs:6},r.createElement(V.Z,null,r.createElement(U.Z,null,r.createElement(H.Z,{hover:!0},r.createElement(z.Z,{className:a.header},"Column names")),r.createElement(H.Z,{hover:!0},r.createElement(z.Z,{style:{whiteSpace:"normal"},className:a.content},r.createElement("div",{style:{overflow:"auto",maxHeight:164}},t.caseBasedDataMgr.columnNamesString))))))))))}));var me=a(3725),ce=a(255),de=a(2248),ue=a(5866),ge=a(8990),pe=a(3199),he=a(9935),Ee=a(7513),ye=a(3657),Me=a(4512);const fe=(0,i.Pi)((e=>{var{i:t,isSelected:a,onSelectClick:n,grouping:i,appMgr:s}=e,l=s.origGroupMgr.unusedOrigins,o=i.origin.concat(l);return r.createElement(H.Z,{hover:!0,role:"checkbox"},r.createElement(z.Z,{padding:"checkbox"},r.createElement(ue.Z,{inputProps:{"aria-labelledby":"labelId".concat(t)},color:"primary",checked:a,onClick:n})),r.createElement(z.Z,{id:"labelId".concat(t),scope:"row",padding:"none"},r.createElement(ye.Z,{style:{width:"100%",fontSize:"0.75rem"},value:i.name,onChange:e=>{s.origGroupMgr.setGroupName(t,e.target.value)}})),r.createElement(z.Z,{style:{padding:"4px 16px 0px 16px",maxWidth:300}},r.createElement(de.Z,{multiple:!0,renderValue:e=>r.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},e.map((e=>r.createElement(Me.Z,{key:e,label:e,style:{margin:2}})))),value:i.origin,style:{width:"100%",fontSize:"0.75rem"},onChange:e=>{s.origGroupMgr.setGroupOrigin(t,e.target.value)},disableUnderline:!0},o.map(((e,t)=>r.createElement(ge.Z,{key:t,value:e,dense:!0},e))))),r.createElement(z.Z,{align:"right"},i.groupCount))})),ve=e=>{var{selectedCount:t,onAddClick:a,onDeleteClick:n}=e,i=0===t;return r.createElement(g.Z,null,r.createElement(p.Z,{variant:"subtitle1",component:"div",style:{flex:"1 1 100%"}},t," selected"),r.createElement(Y.Z,{color:"primary",disabled:i,onClick:n},"Delete"),r.createElement(Y.Z,{color:"primary",onClick:a},"Add"))},be=(0,i.Pi)((e=>{var{appMgr:t}=e,[a,n]=r.useState([]),i=t.origGroupMgr.distributionArray,s=t.origGroupMgr.groupingsJS,l=e=>t=>{var r=a.indexOf(e),i=[];-1===r?i=i.concat(a,e):0===r?i=i.concat(a.slice(1)):r===a.length-1?i=i.concat(a.slice(0,-1)):r>0&&(i=i.concat(a.slice(0,r),a.slice(r+1))),n(i)},o=s.length,m=a.length,c=e=>-1!==a.indexOf(e);return r.createElement(_.Z,{style:{padding:10}},r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:3},r.createElement(p.Z,{variant:"overline"},"Distribution of region of origin"),r.createElement(V.Z,{size:"small",style:{backgroundColor:"rgba(0, 0, 0, 0.02)"}},r.createElement(ce.Z,null,r.createElement(H.Z,null,r.createElement(z.Z,null,"FullRegionOfOrigin"),r.createElement(z.Z,{align:"right"},"Count"))),r.createElement(U.Z,null,i.map(((e,t)=>r.createElement(H.Z,{key:t},r.createElement(z.Z,null,e.origin),r.createElement(z.Z,{align:"right"},e.count))))))),r.createElement(A.Z,{item:!0,xs:9},r.createElement(p.Z,{variant:"overline"},"Migrant variable regrouping"),r.createElement(pe.Z,{style:{width:"100%",fontSize:"0.75rem"}},r.createElement(Ee.Z,null,"Preset"),r.createElement(de.Z,{value:t.origGroupMgr.type,onChange:e=>{t.inputValueSet("groupingPresetSelect",e.target.value),t.origGroupMgr.setType(e.target.value)}},r.createElement(ge.Z,{value:"REPCOUNTRY + UNK + OTHER",dense:!0},"REPCOUNTRY + UNK + OTHER"),r.createElement(ge.Z,{value:"REPCOUNTRY + UNK + SUBAFR + OTHER",dense:!0},"REPCOUNTRY + UNK + SUBAFR + OTHER"),r.createElement(ge.Z,{value:"REPCOUNTRY + UNK + 3 most prevalent regions + OTHER",dense:!0},"REPCOUNTRY + UNK + 3 most prevalent regions + OTHER"),r.createElement(ge.Z,{value:"Custom",dense:!0},"Custom")),r.createElement(he.Z,null,"Select regrouping preset")),r.createElement(V.Z,null,r.createElement(ce.Z,null,r.createElement(H.Z,null,r.createElement(z.Z,{padding:"checkbox"},r.createElement(ue.Z,{inputProps:{"aria-label":"select all"},color:"primary",onClick:e=>{if(e.target.checked){var t=s.map(((e,t)=>t));n(t)}else n([])},checked:o>0&&m===o})),r.createElement(z.Z,{padding:"none"},"GroupedRegionOfOrigin"),r.createElement(z.Z,{width:"60%"},"FullRegionOfOrigin"),r.createElement(z.Z,{align:"right",width:"10%"},"Count"))),r.createElement(U.Z,null,s.map(((e,a)=>r.createElement(fe,{key:a,i:a,grouping:e,appMgr:t,isSelected:c(a),onSelectClick:l(a)}))))),r.createElement(ve,{selectedCount:m,onAddClick:()=>{t.origGroupMgr.addEmptyGrouping()},onDeleteClick:()=>{t.origGroupMgr.removeGroupings(a),n([])}}))))})),De=(0,i.Pi)((e=>{var{appMgr:t}=e;return r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:12},r.createElement(p.Z,{variant:"h6"},"Migrant variable regrouping")),r.createElement(A.Z,{item:!0,xs:2},r.createElement(K,{style:{marginBottom:6},onClick:()=>t.origGroupMgr.applyGroupings()},r.createElement(me.Z,null)," Apply regrouping"),r.createElement(p.Z,{variant:"body2",color:"textSecondary"},"Migrant variable can be created by grouping regions.",r.createElement("br",null),"Choose present or define custom grouping and press 'Apply regrouping' button."),r.createElement(ie,{valid:t.origGroupMgr.actionValid,msg:t.origGroupMgr.actionMessage})),r.createElement(A.Z,{item:!0,xs:10},r.createElement(be,e)))}));var Se=a(4937);const Ze=(0,i.Pi)((e=>{var{appMgr:t}=e,a=[];null!==t.caseBasedDataMgr.columnNames&&(a=t.caseBasedDataMgr.columnNames.slice().sort().map((e=>r.createElement(ge.Z,{key:e,value:e,dense:!0},e))));var n=e=>a=>{t.attrMappingMgr.setDefVal(e,a.target.value)},i=t.attrMappingMgr.mapping.map(((e,i)=>{return r.createElement(H.Z,{hover:!0,key:i},r.createElement(z.Z,null,"".concat(i+1,".")),r.createElement(z.Z,null,e.attribute),r.createElement(z.Z,{style:{padding:"4px 16px 0px 16px"}},r.createElement(de.Z,{style:{width:"100%",fontSize:"0.75rem"},value:e.origColName||"",onChange:(s=e.attribute,e=>{t.attrMappingMgr.setOrigCol(s,e.target.value)}),disableUnderline:!0},r.createElement(ge.Z,{value:"",dense:!0}," "),a)),r.createElement(z.Z,{style:{padding:"4px 16px 0px 16px"}},r.createElement(ye.Z,{style:{width:"100%",fontSize:"0.75rem"},onChange:n(e.attribute),disabled:!!e.origColName})));var s}));return r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:12},r.createElement(p.Z,{variant:"h6"},"Attribute mapping")),r.createElement(A.Z,{item:!0,xs:2},r.createElement(K,{style:{marginBottom:6},onClick:()=>t.attrMappingMgr.applyMapping(),disabled:!t.attrMappingMgr.actionValid},r.createElement(Se.Z,null)," Apply mapping"),r.createElement(p.Z,{variant:"body2",color:"textSecondary"},"Input data must mapped to internal attributes.",r.createElement("br",null),"Adjust mapping and press 'Apply mapping' button."),r.createElement(ie,{valid:t.attrMappingMgr.actionValid,msg:t.attrMappingMgr.actionMessage})),r.createElement(A.Z,{item:!0,xs:10},r.createElement(_.Z,{style:{padding:10}},r.createElement(p.Z,{variant:"overline"},"Attribute mapping"),r.createElement(A.Z,{container:!0,spacing:2},r.createElement(V.Z,null,r.createElement(ce.Z,null,r.createElement(H.Z,null,r.createElement(z.Z,{width:"5%"},"Idx"),r.createElement(z.Z,{width:"25%"},"Attribute"),r.createElement(z.Z,{width:"40%"},"Uploaded data column"),r.createElement(z.Z,{width:"30%"},"Override value"))),r.createElement(U.Z,null,i))))))})),xe=(0,i.Pi)((e=>{var{appMgr:t}=e,a=r.createElement(L.Z,{light:!0,style:{margin:"30px 0"}});return r.createElement(W,null,r.createElement(oe,e),t.uiStateMgr.caseBasedAttrMappingEnabled&&r.createElement(r.Fragment,null,a,r.createElement(Ze,e)),t.uiStateMgr.caseBasedOrigGroupingEnabled&&r.createElement(r.Fragment,null,a,r.createElement(De,e)))}));var Ce=(0,d.Z)({header:{width:142,fontWeight:"bold"},content:{maxWidth:0,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}});const Pe=(0,i.Pi)((e=>{var{appMgr:t}=e,a=Ce();return r.createElement(W,null,r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{display:"flex",justifyContent:"flex-end"},r.createElement(Y.Z,{size:"small",color:"primary",disabled:!t.uiStateMgr.modellingPageEnabled,onClick:e=>t.uiStateMgr.setActivePageId(4)},"Next step"))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(p.Z,{variant:"h6"},"Upload aggregated data")),r.createElement(A.Z,{item:!0,xs:2},r.createElement("input",{style:{display:"none"},id:"aggrUploadBtn",className:"uploadBtn",type:"file",onChange:e=>t.aggrDataMgr.uploadData(e.target)}),r.createElement(G.ZP,{title:"Select aggregated data file"},r.createElement("label",{htmlFor:"aggrUploadBtn"},r.createElement(K,{style:{marginBottom:6}},r.createElement(Q.Z,null)," Upload data"))),r.createElement(p.Z,{variant:"body2",color:"textSecondary"},"Maximum file size: 100MB",r.createElement("br",null),"Supported files types: csv (zip archives)"),r.createElement(ae,{progress:t.aggrDataMgr.fileUploadProgress}),r.createElement(ie,{valid:t.aggrDataMgr.actionValid,msg:t.aggrDataMgr.actionMessage})),r.createElement(A.Z,{item:!0,xs:10},t.aggrDataMgr.actionValid&&r.createElement(_.Z,{style:{padding:10}},r.createElement(p.Z,{variant:"overline"},"Uploaded file details"),r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:6},r.createElement(V.Z,null,r.createElement(U.Z,null,r.createElement(H.Z,{hover:!0},r.createElement(z.Z,{className:a.header},"File name"),r.createElement(z.Z,{className:a.content},t.aggrDataMgr.fileName)),r.createElement(H.Z,{hover:!0},r.createElement(z.Z,{className:a.header},"File path"),r.createElement(z.Z,{className:a.content},t.aggrDataMgr.filePath)),r.createElement(H.Z,{hover:!0},r.createElement(z.Z,{className:a.header},"File size"),r.createElement(z.Z,{className:a.content},se(t.aggrDataMgr.fileSize))),r.createElement(H.Z,{hover:!0},r.createElement(z.Z,{className:a.header},"File type"),r.createElement(z.Z,{className:a.content},t.aggrDataMgr.fileType))))),r.createElement(A.Z,{item:!0,xs:6},r.createElement(V.Z,null,r.createElement(U.Z,null,r.createElement(H.Z,{hover:!0},r.createElement(z.Z,{className:a.header},"Data names")),r.createElement(H.Z,{hover:!0},r.createElement(z.Z,{style:{whiteSpace:"normal"},className:a.content},r.createElement("div",{style:{overflow:"auto",maxHeight:164}},t.aggrDataMgr.dataNamesString))),r.createElement(H.Z,{hover:!0},r.createElement(z.Z,{className:a.header},"Population names")),r.createElement(H.Z,{hover:!0},r.createElement(z.Z,{style:{whiteSpace:"normal"},className:a.content},r.createElement("div",{style:{overflow:"auto",maxHeight:164}},t.aggrDataMgr.populationNamesString)))))))))))})),Ie=(0,i.Pi)((e=>{var{appMgr:t}=e,a=t.uiStateMgr.activeSubPageId;return r.createElement(r.Fragment,null,0===a&&r.createElement(xe,e),1===a&&r.createElement(Pe,e))}));var Ae=a(8233),Fe=a(6380),Ne=a(4645),Re=a(492),Te=a(7410),je=a.n(Te),we={chart:{id:"filter-diag-chart-1",stacked:!0,selection:{enabled:!1,type:"x"},toolbar:{},events:{selection:null,click:null},parentHeightOffset:0},colors:["#69b023","#7bbcc0","#ce80ce","#9d8b56"],title:{style:{fontWeight:"normal"}},legend:{position:"right",offsetY:60},plotOptions:{bar:{columnWidth:"100%"}},dataLabels:{enabled:!1},fill:{},stroke:{show:!0,width:1,colors:"white",curve:"stepline"},xaxis:{title:{text:"Diagnosis year",style:{fontWeight:"normal"}},axisBorder:{show:!1},axisTicks:{show:!1},tickPlacement:"between",tickAmount:31,labels:{style:{fontSize:"10px"}}},yaxis:{title:{text:"Count",style:{fontWeight:"normal"}},axisBorder:{show:!1},axisTicks:{show:!1},labels:{minWidth:50,maxWidth:50,style:{fontSize:"10px"},hideOverlappingLabels:!0,showDuplicates:!1}},grid:{row:{},yaxis:{lines:{show:!1}},padding:{}},tooltip:{enabled:!0,x:{show:!0}},states:{hover:{filter:{type:"darken",value:.15}}}},Ye={chart:{id:"filter-notif-chart-1",stacked:!0,selection:{enabled:!1,type:"x"},toolbar:{},events:{selection:null,click:null},sparkline:{enabled:!1},parentHeightOffset:0},colors:["#69b023","#7bbcc0","#ce80ce","#9d8b56"],title:{style:{fontWeight:"normal"}},legend:{position:"right",offsetY:60},plotOptions:{bar:{columnWidth:"100%"}},dataLabels:{enabled:!1},fill:{},stroke:{show:!0,width:1,colors:"white",curve:"stepline"},xaxis:{type:"category",title:{text:"Notification quarter",style:{fontWeight:"normal"}},axisBorder:{show:!1},axisTicks:{show:!1},tickPlacement:"between",tickAmount:31,labels:{style:{fontSize:"10px"},hideOverlappingLabels:!0,showDuplicates:!1}},yaxis:{title:{text:"Count",style:{fontWeight:"normal"}},axisBorder:{show:!1},axisTicks:{show:!1},labels:{minWidth:50,maxWidth:50,style:{fontSize:"10px"}}},grid:{row:{},yaxis:{lines:{show:!1}}},states:{hover:{filter:{type:"darken",value:.15}}}},Oe={chart:{id:"miss-chart-1",selection:{enabled:!1},toolbar:{enabled:!1},events:{selection:null,click:null},parentHeightOffset:0},colors:["#cccccc"],legend:{enabled:!1},dataLabels:{enabled:!1},fill:{},stroke:{width:1,colors:"white"},plotOptions:{bar:{columnWidth:"100%"}},xaxis:{axisBorder:{show:!1},axisTicks:{show:!1},tickPlacement:"between",position:"bottom",labels:{minHeight:80,maxHeight:80,rotate:-45,rotateAlways:!0,hideOverlappingLabels:!1}},yaxis:{title:{text:"Relative frequency of missing data for each of variables",style:{fontWeight:"normal"}},axisBorder:{show:!1},axisTicks:{show:!1},labels:{minWidth:50,maxWidth:50,formatter:e=>"".concat((100*e).toFixed(0)," %")}},tooltip:{y:{formatter:e=>"".concat((100*e).toFixed(2)," %")}},grid:{yaxis:{lines:{show:!1}}},states:{hover:{filter:{type:"darken",value:.15}}}},ke={chart:{parentHeightOffset:0},dataLabels:{enabled:!1},xaxis:{type:"category",axisBorder:{show:!1},axisTicks:{show:!1},labels:{minHeight:80,maxHeight:80,rotate:-45,rotateAlways:!0,hideOverlappingLabels:!1},floating:!1},stroke:{width:1},yaxis:{title:{text:"Missing data patterns",style:{fontWeight:"normal"}},axisBorder:{show:!1},axisTicks:{show:!1},labels:{show:!1,rotateAlways:!1,hideOverlappingLabels:!1}},legend:{show:!1},tooltip:{y:{formatter:e=>1===e?"Present":"Missing"}},plotOptions:{heatmap:{radius:0,colorScale:{ranges:[{from:0,to:0,color:"#cccccc",name:"Missing"},{from:1,to:1,color:"#69b023",name:"Present"}]}}},states:{hover:{filter:{type:"darken",value:.15}}}},Le={chart:{stacked:!0,parentHeightOffset:0},dataLabels:{enabled:!1},xaxis:{reversed:!0,labels:{show:!1,minHeight:52,maxHeight:52,rotate:-45,rotateAlways:!1,hideOverlappingLabels:!1},axisBorder:{show:!1},axisTicks:{show:!1}},legend:{show:!0,showForSingleSeries:!0,position:"right",offsetY:150},yaxis:{opposite:!0,reversed:!1,axisBorder:{show:!1}},stroke:{show:!0,width:1,colors:"white"},colors:["#69b023","#cccccc"],plotOptions:{bar:{horizontal:!0,barHeight:"100%"}},grid:{padding:{bottom:25},yaxis:{lines:{show:!1}}},tooltip:{y:{formatter:e=>"".concat((100*e).toFixed(2)," %")}},states:{hover:{filter:{type:"darken",value:.15}}}},Be={chart:{dropShadow:{enabled:!1},parentHeightOffset:0},xaxis:{title:{text:"Diagnosis year",style:{fontWeight:"normal"}}},dataLabels:{enabled:!1},stroke:{width:1,curve:"straight",dashArray:2},markers:{size:5,hover:{size:9}},legend:{position:"right",offsetY:150},yaxis:{title:{text:"Proportion of missing values",style:{fontWeight:"normal"}},labels:{minWidth:50,maxWidth:50,formatter:e=>"".concat((100*e).toFixed(0)," %")}},tooltip:{y:{formatter:e=>"".concat((100*e).toFixed(2)," %")}}},We={chart:{parentHeightOffset:15},dataLabels:{enabled:!1},annotations:{xaxis:[{borderColor:"#69b023",strokeDashArray:0,label:{orientation:"horizontal",textAnchor:"start",borderColor:"#69b023",style:{color:"white",background:"#69b023"}}}]},stroke:{width:2,curve:"smooth"},xaxis:{type:"numeric",categories:[0,10,20,30,40,50,60],title:{text:"Notification time in quarters of the year",style:{fontWeight:"normal"},offsetY:10},tickPlacement:"on",tickAmount:20,labels:{formatter:e=>e.toFixed(2)}},yaxis:{min:0,title:{text:"Proportion of reported with the delay",style:{fontWeight:"normal"},offsetY:10},labels:{minWidth:50,maxWidth:50,formatter:e=>e.toFixed(2)}}},Ge={chart:{parentHeightOffset:15},dataLabels:{enabled:!1},annotations:{xaxis:[{borderColor:"#69b023",strokeDashArray:0,label:{orientation:"horizontal",textAnchor:"start",borderColor:"#69b023",style:{color:"white",background:"#69b023"}}}]},stroke:{width:2,curve:"smooth"},xaxis:{type:"numeric",title:{text:"Year",style:{fontWeight:"normal"},offsetY:10},tickPlacement:"on",tickAmount:20,labels:{formatter:e=>e.toFixed(2)}},yaxis:{min:0,title:{text:"Count",style:{fontWeight:"normal"},offsetY:10},labels:{minWidth:50,maxWidth:50,formatter:e=>e.toFixed(2)}}},Ve=(0,d.Z)({valueLabel:{"& span":{"& span":{fontSize:8}}}});const Ue=(0,i.Pi)((e=>{var{appMgr:t}=e,a=Ve(),n=je()({},we,{xaxis:{categories:t.summaryDataMgr.diagYearPlotData.chartCategories}}),i=r.createElement(Re.Z,{options:n,series:t.summaryDataMgr.diagYearPlotData.chartData,type:"bar",height:200});return r.createElement(r.Fragment,null,r.createElement(A.Z,{item:!0,xs:2},r.createElement(Fe.Z,{control:r.createElement(Ne.Z,{checked:t.summaryDataMgr.diagYearPlotData.filter.applyInAdjustments,onChange:e=>t.summaryDataMgr.setDiagYearFilterApply(e.target.checked),color:"primary",size:"small"}),label:"Apply this data selection in adjustments"})),r.createElement(A.Z,{item:!0,xs:10},r.createElement(_.Z,{style:{padding:10}},r.createElement(p.Z,{variant:"overline"},"Diagnosis year"),r.createElement("div",{style:{padding:"40px 105px 0 65px"}},r.createElement(Ae.Z,{min:t.summaryDataMgr.diagYearPlotData.filter.scaleMinYear,max:t.summaryDataMgr.diagYearPlotData.filter.scaleMaxYear,marks:!0,value:[t.summaryDataMgr.diagYearPlotData.filter.valueMinYear,t.summaryDataMgr.diagYearPlotData.filter.valueMaxYear],onChange:(e,a)=>{t.summaryDataMgr.setDiagYearFilterMinYear(a[0]),t.summaryDataMgr.setDiagYearFilterMaxYear(a[1])},valueLabelDisplay:"on",valueLabelFormat:e=>e.toFixed(),classes:{valueLabel:a.valueLabel},"aria-labelledby":"range-slider",getAriaLabel:e=>e.toFixed(),getAriaValueText:e=>e.toFixed(),color:"secondary"})),i)))})),ze=e=>4*(e%1+.125).toFixed(3),He=e=>Math.floor(e)+"Q"+ze(e);var _e=(0,d.Z)({valueLabel:{"& span":{"& span":{fontSize:8}}}});const Qe=(0,i.Pi)((e=>{var{appMgr:t}=e,a=_e(),n=je()({},Ye,{xaxis:{categories:t.summaryDataMgr.notifQuarterChartCategories}}),i=r.createElement(Re.Z,{options:n,series:t.summaryDataMgr.notifQuarterPlotData.chartData,type:"bar",height:200});return r.createElement(r.Fragment,null,r.createElement(A.Z,{item:!0,xs:2},r.createElement(Fe.Z,{control:r.createElement(Ne.Z,{value:t.summaryDataMgr.notifQuarterPlotData.filter.applyInAdjustments,onChange:e=>t.summaryDataMgr.setNotifQuarterFilterApply(e.target.checked),color:"primary",size:"small"}),label:"Apply this data selection in adjustments"})),r.createElement(A.Z,{item:!0,xs:10},r.createElement(_.Z,{style:{padding:10}},r.createElement(p.Z,{variant:"overline"},"Notification quarter"),r.createElement("div",{style:{padding:"40px 105px 0 65px"}},r.createElement(Ae.Z,{min:t.summaryDataMgr.notifQuarterPlotData.filter.scaleMinYear,max:t.summaryDataMgr.notifQuarterPlotData.filter.scaleMaxYear,step:null,marks:t.summaryDataMgr.notifQuarterSliderMarks,value:[t.summaryDataMgr.notifQuarterPlotData.filter.valueMinYear,t.summaryDataMgr.notifQuarterPlotData.filter.valueMaxYear],onChange:(e,a)=>{t.summaryDataMgr.setNotifQuarterFilterMinYear(a[0]),t.summaryDataMgr.setNotifQuarterFilterMaxYear(a[1])},valueLabelDisplay:"on",valueLabelFormat:e=>He(e),classes:{valueLabel:a.valueLabel},"aria-labelledby":"range-slider",color:"secondary"})),i)))}));var Je=a(4065),qe=a(410);const $e=(0,i.Pi)((e=>{var{appMgr:t}=e,a=je()({},Oe,{xaxis:{categories:t.summaryDataMgr.missPlotData.plot1.chartCategories}}),n=je()({},Le,{xaxis:{categories:t.summaryDataMgr.missPlot3Categories}}),i=je()({},Be,{xaxis:{categories:t.summaryDataMgr.missPlot4Categories}});return r.createElement(r.Fragment,null,r.createElement(A.Z,{item:!0,xs:12},r.createElement(p.Z,{variant:"h6"},"Missing data summary: key variables")),r.createElement(A.Z,{item:!0,xs:2},r.createElement(p.Z,{variant:"body2",color:"textSecondary"},"Percentages of cases for which the information was not available (missing) for one or more of the key variables: CD4 count, transmission category, migrant status or age."),r.createElement(pe.Z,{component:"fieldset"},r.createElement(qe.Z,{name:"missDataSelection",value:t.summaryDataMgr.missPlotSelection,onChange:e=>t.summaryDataMgr.setMissPlotSelection(e.target.value)},r.createElement(Fe.Z,{value:"all",control:r.createElement(Je.Z,{color:"primary",size:"small"}),label:"All"}),r.createElement(Fe.Z,{value:"female",control:r.createElement(Je.Z,{color:"primary",size:"small"}),label:"Female"}),r.createElement(Fe.Z,{value:"male",control:r.createElement(Je.Z,{color:"primary",size:"small"}),label:"Male"})))),r.createElement(A.Z,{item:!0,xs:10},r.createElement(_.Z,{style:{padding:10}},r.createElement(A.Z,{container:!0},r.createElement(A.Z,{item:!0,xs:3},r.createElement(Re.Z,{options:a,series:t.summaryDataMgr.missPlot1Series,type:"bar",height:400})),r.createElement(A.Z,{item:!0,xs:4},r.createElement(Re.Z,{options:ke,series:t.summaryDataMgr.missPlot2Series,type:"heatmap",height:400})),r.createElement(A.Z,{item:!0,xs:5},r.createElement(Re.Z,{options:n,series:t.summaryDataMgr.missPlot3Series,type:"bar",height:400})),r.createElement(A.Z,{item:!0,xs:12},r.createElement(Re.Z,{options:i,series:t.summaryDataMgr.missPlot4Series,type:"area",height:400}))))))})),Ke=(0,i.Pi)((e=>{var{appMgr:t}=e,a=je()({},We,{annotations:{xaxis:[{x:t.summaryDataMgr.repDelPlot.q95,label:{text:"95% of cases reported by ".concat(t.summaryDataMgr.repDelPlot.q95," quarters")}}]}});return r.createElement(r.Fragment,null,r.createElement(A.Z,{item:!0,xs:12},r.createElement(p.Z,{variant:"h6"},"Reporting delays summary")),r.createElement(A.Z,{item:!0,xs:2},r.createElement(p.Z,{variant:"body2",color:"textSecondary"},"Average reporting delay for cases notified within a quarter and the upper bound for typical average delay values. Quarters when the average delay exceeds the upper bound may indicate cleaning events in surveillance."),r.createElement(pe.Z,{component:"fieldset"},r.createElement(qe.Z,{name:"repDelDataSelection",value:t.summaryDataMgr.repDelPlotSelection,onChange:e=>t.summaryDataMgr.setRepDelPlotSelection(e.target.value)},r.createElement(Fe.Z,{value:"all",control:r.createElement(Je.Z,{color:"primary",size:"small"}),label:"All"}),r.createElement(Fe.Z,{value:"female",control:r.createElement(Je.Z,{color:"primary",size:"small"}),label:"Female"}),r.createElement(Fe.Z,{value:"male",control:r.createElement(Je.Z,{color:"primary",size:"small"}),label:"Male"})))),r.createElement(A.Z,{item:!0,xs:10},r.createElement(_.Z,{style:{padding:10}},r.createElement(Re.Z,{options:a,series:t.summaryDataMgr.repDelPlot.series,type:"area",height:400}))))})),Xe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return ee(e)?"":Number(e).toLocaleString(void 0,{style:"percent",minimumFractionDigits:t})},et=(0,i.Pi)((e=>{var{appMgr:t}=e;return r.createElement(W,null,r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{display:"flex",justifyContent:"flex-end"},r.createElement(Y.Z,{size:"small",color:"primary",disabled:!t.uiStateMgr.caseBasedAdjustmentsStageEnabled,onClick:e=>t.uiStateMgr.setActiveStepId(3)},"Next step"))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(p.Z,{variant:"h6"},"Select case-based data for summary")),r.createElement(Ue,e),r.createElement(Qe,e),r.createElement(A.Z,{item:!0,xs:12},r.createElement(p.Z,{variant:"body1"},"Number of records in the selection: ",t.summaryDataMgr.selectedCount," (out of ",t.summaryDataMgr.totalCount,", ",Xe(t.summaryDataMgr.selectedCount/t.summaryDataMgr.totalCount),")")),r.createElement(A.Z,{item:!0,xs:12},r.createElement(L.Z,{light:!0,style:{margin:"30px 0"}})),r.createElement($e,e),r.createElement(A.Z,{item:!0,xs:12},r.createElement(L.Z,{light:!0,style:{margin:"30px 0"}})),r.createElement(Ke,e)))})),tt=()=>r.createElement(r.Fragment,null,r.createElement(p.Z,{variant:"overline"},"No parameters"),r.createElement(p.Z,null,"No Multiple Imputations adjustment selected"));var at=a(9239),rt=a(4724);const nt=(0,i.Pi)((e=>{var{appMgr:t}=e;return r.createElement(r.Fragment,null,r.createElement(p.Z,{variant:"overline"},"Joint Modelling - JOMO parameters"),r.createElement("form",{noValidate:!0,autoComplete:"off"},r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:4},r.createElement(at.Z,{label:"Number of imputations",helperText:"Type the number of data sets to input",type:"number",value:t.adjustMgr.miJomoSettings.nimp,onChange:e=>t.adjustMgr.setMIJomoNimp(e.target.value),onBlur:e=>t.adjustMgr.setMIJomoNimp(Math.min(Math.max(e.target.value,2),50)),fullWidth:!0,InputProps:{inputProps:{min:2,max:50}},style:{marginBottom:20}})),r.createElement(A.Z,{item:!0,xs:4},r.createElement(at.Z,{label:"Number of burn-in iterations",helperText:"Type the number of inital iterations to skip before imputing",type:"number",value:t.adjustMgr.miJomoSettings.nburn,onChange:e=>t.adjustMgr.setMIJomoNburn(e.target.value),onBlur:e=>t.adjustMgr.setMIJomoNburn(Math.min(Math.max(e.target.value,100),1e4)),fullWidth:!0,InputProps:{inputProps:{min:100,max:1e4}},style:{marginBottom:20}})),r.createElement(A.Z,{item:!0,xs:4},r.createElement(at.Z,{label:"Number of iterations between two successive imputations",type:"number",value:t.adjustMgr.miJomoSettings.nbetween,onChange:e=>t.adjustMgr.setMIJomoNbetween(e.target.value),onBlur:e=>t.adjustMgr.setMIJomoNbetween(Math.min(Math.max(e.target.value,100),1e4)),fullWidth:!0,InputProps:{inputProps:{min:100,max:1e4}},style:{marginBottom:20}})),r.createElement(A.Z,{item:!0,xs:4},r.createElement(p.Z,{id:"discrete-slider",gutterBottom:!0},"Number of degrees of freedom for spline of diagnosis calendar year"),r.createElement(Ae.Z,{min:3,max:5,value:t.adjustMgr.miJomoSettings.nsdf,onChange:(e,a)=>t.adjustMgr.setMIJomoNsdf(a),marks:[{value:3,label:3},{value:4,label:4},{value:5,label:5}]})),r.createElement(A.Z,{item:!0,xs:4},r.createElement(rt.Z,{row:!0},r.createElement(Fe.Z,{control:r.createElement(ue.Z,{checked:t.adjustMgr.miJomoSettings.imputeRD,onChange:(e,a)=>t.adjustMgr.setMIJomoImputeRD(a),name:"check",color:"primary"}),label:"Impute reporting delays inputs"}))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(Y.Z,{color:"primary",onClick:e=>t.adjustMgr.restoreMIDefaults("jomo")},"Restore defaults")))))})),it=(0,i.Pi)((e=>{var{appMgr:t}=e;return r.createElement(r.Fragment,null,r.createElement(p.Z,{variant:"overline"},"Chained Equations - MICE parameters"),r.createElement("form",{noValidate:!0,autoComplete:"off"},r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:4},r.createElement(at.Z,{label:"Number of imputations",helperText:"Type the number of data sets to input",type:"number",value:t.adjustMgr.miMiceSettings.nimp,onChange:e=>t.adjustMgr.setMIMiceNimp(e.target.value),onBlur:e=>t.adjustMgr.setMIMiceNimp(Math.min(Math.max(e.target.value,2),50)),fullWidth:!0,InputProps:{inputProps:{min:2,max:50}},style:{marginBottom:20}})),r.createElement(A.Z,{item:!0,xs:4},r.createElement(at.Z,{label:"Number of mice iterations",helperText:"Type the number of mice iterations",type:"number",value:t.adjustMgr.miMiceSettings.nit,onChange:e=>t.adjustMgr.setMIMiceNit(e.target.value),onBlur:e=>t.adjustMgr.setMIMiceNit(Math.min(Math.max(e.target.value,2),50)),fullWidth:!0,InputProps:{inputProps:{min:2,max:50}},style:{marginBottom:20}})),r.createElement(A.Z,{item:!0,xs:4}),r.createElement(A.Z,{item:!0,xs:4},r.createElement(p.Z,{id:"discrete-slider",gutterBottom:!0},"Number of degrees of freedom for spline of diagnosis calendar year"),r.createElement(Ae.Z,{min:3,max:5,value:t.adjustMgr.miMiceSettings.nsdf,onChange:(e,a)=>t.adjustMgr.setMIMiceNsdf(a),marks:[{value:3,label:3},{value:4,label:4},{value:5,label:5}]})),r.createElement(A.Z,{item:!0,xs:4},r.createElement(rt.Z,{row:!0},r.createElement(Fe.Z,{control:r.createElement(ue.Z,{checked:t.adjustMgr.miMiceSettings.imputeRD,onChange:(e,a)=>t.adjustMgr.setMIMiceImputeRD(a),name:"check",color:"primary"}),label:"Impute reporting delays inputs"}))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(Y.Z,{color:"primary",onClick:e=>t.adjustMgr.restoreMIDefaults("mice")},"Restore defaults")))))})),st=(0,i.Pi)((e=>{var{appMgr:t}=e;return r.createElement(r.Fragment,null,r.createElement(A.Z,{item:!0,xs:2},"Multiple Imputations type:",r.createElement("br",null),r.createElement(pe.Z,{component:"fieldset"},r.createElement(qe.Z,{name:"miAdjustType",value:t.adjustMgr.miAdjustType,onChange:e=>t.adjustMgr.setMIAdjustType(e.target.value)},r.createElement(Fe.Z,{value:"none",control:r.createElement(Je.Z,{color:"primary",size:"small"}),label:"None"}),r.createElement(Fe.Z,{value:"jomo",control:r.createElement(Je.Z,{color:"primary",size:"small"}),label:"Joint Modelling - JOMO"}),r.createElement(Fe.Z,{value:"mice",control:r.createElement(Je.Z,{color:"primary",size:"small"}),label:"Chained Equations - MICE"})))),r.createElement(A.Z,{item:!0,xs:10},r.createElement(_.Z,{style:{padding:10,minHeight:283}},"none"===t.adjustMgr.miAdjustType&&r.createElement(tt,null),"jomo"===t.adjustMgr.miAdjustType&&r.createElement(nt,e),"mice"===t.adjustMgr.miAdjustType&&r.createElement(it,e))))})),lt=()=>r.createElement(r.Fragment,null,r.createElement(p.Z,{variant:"overline"},"No parameters"),r.createElement(p.Z,null,"No Reporting Delays adjustment selected")),ot=(0,i.Pi)((e=>{var{appMgr:t}=e;return r.createElement(r.Fragment,null,r.createElement(p.Z,{variant:"overline"},"Reporting Delays - without trend parameters"),r.createElement("form",{noValidate:!0,autoComplete:"off"},r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:4},r.createElement(at.Z,{label:"Diagnosis start year",helperText:"Enter the start year for diagnosis",type:"number",value:t.adjustMgr.rdWithoutTrendSettings.startYear,onChange:e=>t.adjustMgr.setRDWithoutStartYear(e.target.value),onBlur:e=>t.adjustMgr.setRDWithoutStartYear(Math.min(Math.max(e.target.value,1975),2030)),fullWidth:!0,InputProps:{inputProps:{min:1975,max:2030}},style:{marginBottom:20}})),r.createElement(A.Z,{item:!0,xs:4},r.createElement(at.Z,{label:"Notification end year",helperText:"Enter the end year for notification",type:"number",value:t.adjustMgr.rdWithoutTrendSettings.endYear,onChange:e=>t.adjustMgr.setRDWithoutEndYear(e.target.value),onBlur:e=>t.adjustMgr.setRDWithoutEndYear(Math.min(Math.max(e.target.value,1975),2030)),fullWidth:!0,InputProps:{inputProps:{min:1975,max:2030}},style:{marginBottom:20}})),r.createElement(A.Z,{item:!0,xs:4},r.createElement(at.Z,{label:"Notification end quarter (integer between 1 and 4)",type:"number",value:t.adjustMgr.rdWithoutTrendSettings.endQrt,onChange:e=>t.adjustMgr.setRDWithoutEndQrt(e.target.value),onBlur:e=>t.adjustMgr.setRDWithoutEndQrt(Math.min(Math.max(e.target.value,1),4)),fullWidth:!0,InputProps:{inputProps:{min:1,max:4}},style:{marginBottom:20}})),r.createElement(A.Z,{item:!0,xs:4},"Stratify by:",r.createElement(rt.Z,{row:!0},r.createElement(Fe.Z,{control:r.createElement(ue.Z,{checked:t.adjustMgr.rdWithoutTrendSettings.stratGender,onChange:(e,a)=>t.adjustMgr.setRDWithoutStratGender(a),name:"check",color:"primary"}),label:"Gender"}),r.createElement(Fe.Z,{control:r.createElement(ue.Z,{checked:t.adjustMgr.rdWithoutTrendSettings.stratTrans,onChange:(e,a)=>t.adjustMgr.setRDWithoutStratTrans(a),name:"check",color:"primary"}),label:"Transmission"}),r.createElement(Fe.Z,{control:r.createElement(ue.Z,{checked:t.adjustMgr.rdWithoutTrendSettings.stratMigr,onChange:(e,a)=>t.adjustMgr.setRDWithoutStratMigr(a),name:"check",color:"primary"}),label:"Migration"}))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(Y.Z,{color:"primary",onClick:e=>t.adjustMgr.restoreRDDefaults("withoutTrend")},"Restore defaults")))))})),mt=(0,i.Pi)((e=>{var{appMgr:t}=e;return r.createElement(r.Fragment,null,r.createElement(p.Z,{variant:"overline"},"Reporting Delays - with trend parameters"),r.createElement("form",{noValidate:!0,autoComplete:"off"},r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:4},r.createElement(at.Z,{label:"Diagnosis start year",helperText:"Enter the start year for diagnosis",type:"number",value:t.adjustMgr.rdWithTrendSettings.startYear,onChange:e=>t.adjustMgr.setRDWithStartYear(e.target.value),onBlur:e=>t.adjustMgr.setRDWithStartYear(Math.min(Math.max(e.target.value,1975),2030)),fullWidth:!0,InputProps:{inputProps:{min:1975,max:2030}},style:{marginBottom:20}})),r.createElement(A.Z,{item:!0,xs:4},r.createElement(at.Z,{label:"Notification end year",helperText:"Enter the end year for notification",type:"number",value:t.adjustMgr.rdWithTrendSettings.endYear,onChange:e=>t.adjustMgr.setRDWithEndYear(e.target.value),onBlur:e=>t.adjustMgr.setRDWithEndYear(Math.min(Math.max(e.target.value,1975),2030)),fullWidth:!0,InputProps:{inputProps:{min:1975,max:2030}},style:{marginBottom:20}})),r.createElement(A.Z,{item:!0,xs:4},r.createElement(at.Z,{label:"Notification end quarter (integer between 1 and 4)",type:"number",value:t.adjustMgr.rdWithTrendSettings.endQrt,onChange:e=>t.adjustMgr.setRDWithEndQrt(e.target.value),onBlur:e=>t.adjustMgr.setRDWithEndQrt(Math.min(Math.max(e.target.value,1),4)),fullWidth:!0,InputProps:{inputProps:{min:1,max:4}},style:{marginBottom:20}})),r.createElement(A.Z,{item:!0,xs:4},"Stratify by:",r.createElement(rt.Z,{row:!0},r.createElement(Fe.Z,{control:r.createElement(ue.Z,{checked:t.adjustMgr.rdWithTrendSettings.stratGender,onChange:(e,a)=>t.adjustMgr.setRDWithStratGender(a),name:"check",color:"primary"}),label:"Gender"}),r.createElement(Fe.Z,{control:r.createElement(ue.Z,{checked:t.adjustMgr.rdWithTrendSettings.stratTrans,onChange:(e,a)=>t.adjustMgr.setRDWithStratTrans(a),name:"check",color:"primary"}),label:"Transmission"}),r.createElement(Fe.Z,{control:r.createElement(ue.Z,{checked:t.adjustMgr.rdWithTrendSettings.stratMigr,onChange:(e,a)=>t.adjustMgr.setRDWithStratMigr(a),name:"check",color:"primary"}),label:"Migration"}))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(Y.Z,{color:"primary",onClick:e=>t.adjustMgr.restoreRDDefaults("withTrend")},"Restore defaults")))))})),ct=(0,i.Pi)((e=>{var{appMgr:t}=e;return r.createElement(r.Fragment,null,r.createElement(A.Z,{item:!0,xs:2},"Reporting Delays type:",r.createElement("br",null),r.createElement(pe.Z,{component:"fieldset"},r.createElement(qe.Z,{name:"rdAdjustType",value:t.adjustMgr.rdAdjustType,onChange:e=>t.adjustMgr.setRDAdjustType(e.target.value)},r.createElement(Fe.Z,{value:"none",control:r.createElement(Je.Z,{color:"primary",size:"small"}),label:"None"}),r.createElement(Fe.Z,{value:"withoutTrend",control:r.createElement(Je.Z,{color:"primary",size:"small"}),label:"Without trend"}),r.createElement(Fe.Z,{value:"withTrend",control:r.createElement(Je.Z,{color:"primary",size:"small"}),label:"With trend"})))),r.createElement(A.Z,{item:!0,xs:10},r.createElement(_.Z,{style:{padding:10,minHeight:263}},"none"===t.adjustMgr.rdAdjustType&&r.createElement(lt,null),"withoutTrend"===t.adjustMgr.rdAdjustType&&r.createElement(ot,e),"withTrend"===t.adjustMgr.rdAdjustType&&r.createElement(mt,e))))})),dt=(0,i.Pi)((e=>{var{appMgr:t}=e;return r.createElement(W,null,r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{display:"flex",justifyContent:"flex-end"},r.createElement(Y.Z,{size:"small",color:"primary",disabled:!t.adjustMgr.adjustmentSelected,onClick:e=>t.uiStateMgr.setActivePageId(3,1)},"Next step"))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(p.Z,{variant:"h6"},"Case-based data adjustments parameters")),r.createElement(st,e),r.createElement(ct,e)))}));var ut=a(2979),gt=a(7096),pt=a(4891),ht=(0,d.Z)((()=>({root:{marginTop:10,marginBottom:10,height:10}}))),Et=e=>{var{progress:t}=e;if(ee(t))return null;var a=ht();return r.createElement(X.Z,{color:"secondary",className:a.root})};const yt=(0,i.Pi)((e=>{var{appMgr:t}=e,[a,n]=r.useState(0);return r.createElement(W,null,r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{display:"flex",justifyContent:"flex-end"},r.createElement(Y.Z,{size:"small",color:"primary",disabled:!t.uiStateMgr.reportsPageEnabled,onClick:e=>t.uiStateMgr.setActivePageId(5)},"Next step"))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(p.Z,{variant:"h6"},"Case-based data adjustments run")),r.createElement(A.Z,{item:!0,xs:2},r.createElement(K,{onClick:()=>t.adjustMgr.runAdjustments(),disabled:!t.adjustMgr.adjustmentSelected||t.adjustMgr.adjustmentsRunInProgress},r.createElement(ut.Z,null)," Run adjustments"),r.createElement(Y.Z,{onClick:()=>t.adjustMgr.cancelAdjustments(),color:"primary",style:{marginLeft:20},disabled:!t.adjustMgr.adjustmentsRunInProgress},"Cancel"),r.createElement(Et,{progress:t.adjustMgr.adjustmentsRunProgress})),r.createElement(A.Z,{item:!0,xs:10},r.createElement(_.Z,{style:{padding:10}},r.createElement(gt.Z,{value:a,onChange:(e,t)=>n(t),indicatorColor:"primary",textColor:"primary"},r.createElement(pt.Z,{label:"Run log",disabled:ee(t.adjustMgr.adjustmentsRunLog)}),r.createElement(pt.Z,{label:"Diagnostics",disabled:ee(t.adjustMgr.adjustmentsReport)})),0===a&&r.createElement(r.Fragment,null,r.createElement("pre",{dangerouslySetInnerHTML:{__html:t.adjustMgr.adjustmentsRunLog},style:{overflowX:"auto"}})),1===a&&r.createElement(r.Fragment,null,r.createElement("div",{dangerouslySetInnerHTML:{__html:t.adjustMgr.adjustmentsReport},style:{overflowX:"auto"}}))))))})),Mt=(0,i.Pi)((e=>{var{appMgr:t}=e,a=t.uiStateMgr.activeSubPageId;return r.createElement(r.Fragment,null,0===a&&r.createElement(dt,e),1===a&&r.createElement(yt,e))})),ft=(0,i.Pi)((e=>{var{i:t,isSelected:a,onSelectClick:n,population:i,appMgr:s}=e;return r.createElement(H.Z,{hover:!0,role:"checkbox"},r.createElement(z.Z,{padding:"checkbox"},r.createElement(ue.Z,{inputProps:{"aria-labelledby":"labelId".concat(t)},color:"primary",checked:a,onClick:n})),r.createElement(z.Z,{style:{padding:"4px 16px 0px 16px",maxWidth:300}},r.createElement(de.Z,{multiple:!0,renderValue:e=>r.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},e.map((e=>r.createElement(Me.Z,{key:e,label:e,style:{margin:2}})))),value:i.variables,style:{width:"100%",fontSize:"0.75rem"},onChange:e=>{s.popMgr.setPopulationVariables(t,e.target.value)},disableUnderline:!0},s.popMgr.availableVariables.map(((e,t)=>r.createElement(ge.Z,{key:t,value:e.Name,dense:!0},"".concat(e.Name," (").concat(e.Code,")")))))),r.createElement(z.Z,null,r.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},i.strata.map((e=>{return r.createElement(Me.Z,{key:e.Combination,label:"".concat(e.Combination," (").concat(Xe(e.Perc),")"),style:{margin:2,backgroundColor:"".concat((t=e.Perc,a=214,((e,t,a)=>{a/=100;var r=t*Math.min(a,1-a)/100,n=t=>{var n=(t+e/30)%12,i=a-r*Math.max(Math.min(n-3,9-n,1),-1);return Math.round(255*i).toString(16).padStart(2,"0")};return"#".concat(n(0)).concat(n(8)).concat(n(4))})(a,40+60*t,95-40*t)))}});var t,a})))))})),vt=(0,i.Pi)((e=>{var{appMgr:t}=e,[a,n]=r.useState([]),i=t.popMgr.populationsJS,s=e=>t=>{var r=a.indexOf(e),i=[];-1===r?i=i.concat(a,e):0===r?i=i.concat(a.slice(1)):r===a.length-1?i=i.concat(a.slice(0,-1)):r>0&&(i=i.concat(a.slice(0,r),a.slice(r+1))),n(i)},l=i.length,o=a.length,m=e=>-1!==a.indexOf(e);return r.createElement(_.Z,null,r.createElement(V.Z,null,r.createElement(ce.Z,null,r.createElement(H.Z,null,r.createElement(z.Z,{padding:"checkbox"},r.createElement(ue.Z,{inputProps:{"aria-label":"select all"},color:"primary",onClick:e=>{if(e.target.checked){var t=i.map(((e,t)=>t));n(t)}else n([])},checked:l>0&&o===l})),r.createElement(z.Z,{width:"50%"},"Selected variables"),r.createElement(z.Z,{width:"50%"},"Defined populations"))),r.createElement(U.Z,null,i.map(((e,a)=>r.createElement(ft,{key:a,i:a,population:e,appMgr:t,isSelected:m(a),onSelectClick:s(a)}))))),r.createElement(ve,{selectedCount:o,onAddClick:()=>{t.popMgr.addEmptyPopulation()},onDeleteClick:()=>{t.popMgr.removePopulations(a),n([])}}))})),bt=e=>r.createElement(W,null,r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{display:"flex",justifyContent:"flex-end"},r.createElement(Y.Z,{size:"small",color:"primary"},"Next step"))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(p.Z,{variant:"h6"},"Case-based data")),r.createElement(A.Z,{item:!0,xs:2},r.createElement(p.Z,null,"Create populations from data"),r.createElement(p.Z,{variant:"body2",color:"textSecondary"},"Stratify data by values present in the data. Select one or more variables.")),r.createElement(A.Z,{item:!0,xs:10},r.createElement(vt,e)))),Dt=(0,i.Pi)((e=>{var t,{i:a,isSelected:n,onSelectClick:i,interval:s,collection:l}=e;return t=0===a?s.startYear:r.createElement(ye.Z,{style:{width:"100%",fontSize:"0.75rem"},value:s.startYear,type:"number",onChange:e=>l.setIntervalStartYear(a,e.target.value)}),r.createElement(H.Z,{hover:!0,role:"checkbox"},r.createElement(z.Z,{padding:"checkbox"},r.createElement(ue.Z,{inputProps:{"aria-labelledby":"labelId".concat(a)},color:"primary",checked:n,onClick:i})),r.createElement(z.Z,{id:"labelId1",scope:"row",padding:"none"},t),r.createElement(z.Z,null,s.endYear),r.createElement(z.Z,{padding:"checkbox"},r.createElement(ue.Z,{color:"primary",checked:s.jump,onChange:e=>l.setIntervalJump(a,e.target.checked)})),r.createElement(z.Z,{padding:"checkbox"},r.createElement(ue.Z,{color:"primary",checked:s.changeInInterval,onChange:e=>l.setIntervalChangeInInterval(a,e.target.checked)})),r.createElement(z.Z,{padding:"checkbox"},r.createElement(ue.Z,{color:"primary",checked:s.diffByCD4,onChange:e=>l.setIntervalDiffByCD4(a,e.target.checked)})))})),St=(0,i.Pi)((e=>{var{timeIntCollMgr:t}=e,[a,n]=r.useState([]),i=t.selectedEditCollection,s=i.intervals,l=e=>t=>{var r=a.indexOf(e),i=[];-1===r?i=i.concat(a,e):0===r?i=i.concat(a.slice(1)):r===a.length-1?i=i.concat(a.slice(0,-1)):r>0&&(i=i.concat(a.slice(0,r),a.slice(r+1))),n(i)},o=s.length,m=a.length,c=e=>-1!==a.indexOf(e);return r.createElement(_.Z,null,r.createElement(V.Z,null,r.createElement(ce.Z,null,r.createElement(H.Z,null,r.createElement(z.Z,{padding:"checkbox"},r.createElement(ue.Z,{inputProps:{"aria-label":"select all"},color:"primary",onClick:e=>{if(e.target.checked){var t=s.map(((e,t)=>t));n(t)}else n([])},checked:o>0&&m===o}),"            "),r.createElement(z.Z,{width:"15%",padding:"none"},"Start year"),r.createElement(z.Z,{width:"15%"},"End year"),r.createElement(z.Z,null,"Jump"),r.createElement(z.Z,null,"Change by CD4 count"),r.createElement(z.Z,null,"Change in interval"))),r.createElement(U.Z,null,s.map(((e,t)=>r.createElement(Dt,{key:t,i:t,interval:e,collection:i,isSelected:c(t),onSelectClick:l(t)}))))),r.createElement(ve,{selectedCount:m,onAddClick:()=>{i.addEmptyInterval()},onDeleteClick:()=>{i.removeIntervals(a),n([])}}))})),Zt=(0,i.Pi)((e=>{var{timeIntCollMgr:t}=e,a=t.defaultEditCollectionSelected;return r.createElement(r.Fragment,null,r.createElement(de.Z,{value:t.selectedEditCollectionId,onChange:e=>t.setSelectedEditCollectionId(e.target.value),style:{width:"100%",fontSize:"0.75rem"}},t.collectionsArray.map(((e,t)=>r.createElement(ge.Z,{key:t,value:e.id,dense:!0},e.name)))),r.createElement(Y.Z,{color:"primary",onClick:()=>t.deleteSelectedEditCollection(),disabled:a},"Delete"),r.createElement(Y.Z,{color:"primary",onClick:()=>t.addNewCollection()},"Add"))})),xt=(0,i.Pi)((e=>{var{appMgr:t}=e;return r.createElement(W,null,r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{display:"flex",justifyContent:"flex-end"},r.createElement(Y.Z,{size:"small",color:"primary"},"Next step"))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(p.Z,{color:"textSecondary"},"Upload model parameters file")),r.createElement(A.Z,{item:!0,xs:3},r.createElement("input",{style:{display:"none"},id:"modelUploadBtn",type:"file",onChange:e=>t.modelMgr.setModelsParamFile(e.nativeEvent.target.files[0])}),r.createElement("label",{htmlFor:"modelUploadBtn"},r.createElement(K,null,r.createElement(Q.Z,null)," Upload model")),r.createElement(p.Z,{variant:"body2",color:"textSecondary",style:{marginTop:10}},"Parameters loaded from model file override those determined from data.",r.createElement("br",null),"Supported files types: xml (uncompressed and zip archives)")),r.createElement(A.Z,{item:!0,xs:9},r.createElement(_.Z,{style:{padding:10}},r.createElement(p.Z,{variant:"overline"},"Uploaded file details"),r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:12},r.createElement(V.Z,null,r.createElement(U.Z,null,r.createElement(H.Z,{hover:!0},r.createElement(z.Z,{width:100},"File name"),r.createElement(z.Z,null,t.modelMgr.modelsParamFileName)))))))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(L.Z,{light:!0,style:{margin:"30px 0"}})),r.createElement(A.Z,{item:!0,xs:3},r.createElement(p.Z,{color:"textSecondary"},"Time intervals and diagnosis rates modelling"),r.createElement(Zt,{timeIntCollMgr:t.modelMgr.timeIntCollMgr})),r.createElement(A.Z,{item:!0,xs:9},r.createElement(St,{timeIntCollMgr:t.modelMgr.timeIntCollMgr}))))}));var Ct=e=>{var{minYear:t,maxYear:a,onChange:n}=e;return r.createElement(Ae.Z,{min:1975,max:2025,marks:[{value:1975,label:"1975"},{value:2025,label:"2025"}],value:[t,a],onChange:n,valueLabelDisplay:"on",valueLabelFormat:e=>e.toFixed(),"aria-labelledby":"range-slider",getAriaLabel:e=>e.toFixed(),getAriaValueText:e=>e.toFixed(),color:"secondary"})};const Pt=(0,i.Pi)((e=>{var{appMgr:t}=e;return r.createElement(_.Z,null,r.createElement(A.Z,{container:!0},r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{style:{padding:10}},r.createElement(p.Z,{variant:"overline"},"1. Range of calculations"),r.createElement("div",{style:{padding:"40px 10px 0 10px"}},r.createElement(Ct,{minYear:t.modelMgr.minYear,maxYear:t.modelMgr.maxYear,onChange:(e,a)=>{t.modelMgr.setMinYear(a[0]),t.modelMgr.setMaxYear(a[1])}})))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{style:{padding:10}},r.createElement(p.Z,{variant:"overline"},"2. HIV diagnoses, total"),r.createElement("div",{style:{padding:"40px 10px 0 10px"}},r.createElement(Ct,{minYear:t.modelMgr.minFitPos,maxYear:t.modelMgr.maxFitPos,onChange:(e,a)=>{t.modelMgr.setMinFitPos(a[0]),t.modelMgr.setMaxFitPos(a[1])}})))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{style:{padding:10}},r.createElement(p.Z,{variant:"overline"},"3. HIV diagnoses, by CD4 count"),r.createElement("div",{style:{padding:"40px 10px 0 10px"}},r.createElement(Ct,{minYear:t.modelMgr.minFitCD4,maxYear:t.modelMgr.maxFitCD4,onChange:(e,a)=>{t.modelMgr.setMinFitCD4(a[0]),t.modelMgr.setMaxFitCD4(a[1])}})))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{style:{padding:10}},r.createElement(p.Z,{variant:"overline"},"4. AIDS diagnoses, total"),r.createElement("div",{style:{padding:"40px 10px 0 10px"}},r.createElement(Ct,{minYear:t.modelMgr.minFitAIDS,maxYear:t.modelMgr.maxFitAIDS,onChange:(e,a)=>{t.modelMgr.setMinFitAIDS(a[0]),t.modelMgr.setMaxFitAIDS(a[1])}})))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{style:{padding:10}},r.createElement(p.Z,{variant:"overline"},"5. HIV/AIDS diagnoses, total"),r.createElement("div",{style:{padding:"40px 10px 0 10px"}},r.createElement(Ct,{minYear:t.modelMgr.minFitHIVAIDS,maxYear:t.modelMgr.maxFitHIVAIDS,onChange:(e,a)=>{t.modelMgr.setMinFitHIVAIDS(a[0]),t.modelMgr.setMaxFitHIVAIDS(a[1])}})))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{style:{padding:10}},r.createElement(p.Z,{variant:"overline"},"6. Full/partial data"),r.createElement(A.Z,{container:!0},r.createElement(A.Z,{item:!0,xs:6},"Do you have data from the start of the epidemic"),r.createElement(A.Z,{item:!0,xs:6},r.createElement(Ne.Z,{color:"primary",checked:t.modelMgr.fullData,onChange:e=>t.modelMgr.setFullData(e.target.checked),size:"small"}))))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{style:{padding:10}},r.createElement(p.Z,{variant:"overline"},"7. Incidence curve"),r.createElement(A.Z,{container:!0},r.createElement(A.Z,{item:!0,xs:6},"Knots count"),r.createElement(A.Z,{item:!0,xs:6},r.createElement(ye.Z,{style:{width:"100%",fontSize:"0.75rem"},value:t.modelMgr.knotsCount,onChange:e=>t.modelMgr.setKnotsCount(e.target.value),type:"number"})),r.createElement(A.Z,{item:!0,xs:6},"Start at zero"),r.createElement(A.Z,{item:!0,xs:6},r.createElement(Ne.Z,{color:"primary",checked:t.modelMgr.startIncZero,onChange:e=>t.modelMgr.setStartIncZero(e.target.checked),size:"small"})),r.createElement(A.Z,{item:!0,xs:6},"Prevent sudden changes at end of observation interval"),r.createElement(A.Z,{item:!0,xs:6},r.createElement(Ne.Z,{color:"primary",checked:t.modelMgr.maxIncCorr,onChange:e=>t.modelMgr.setMaxIncCorr(e.target.checked),size:"small"}))))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{style:{padding:10}},r.createElement(p.Z,{variant:"overline"},"8. Maximum likelihood"),r.createElement(A.Z,{container:!0},r.createElement(A.Z,{item:!0,xs:6},"Distrbution"),r.createElement(A.Z,{item:!0,xs:6},r.createElement(qe.Z,{row:!0,value:t.modelMgr.distributionFit,onChange:e=>t.modelMgr.setDistributionFit(e.target.value)},r.createElement(Fe.Z,{value:"POISSON",control:r.createElement(Je.Z,{color:"primary"}),label:"Poisson"}),r.createElement(Fe.Z,{value:"NEGATIVE_BINOMIAL",control:r.createElement(Je.Z,{color:"primary"}),label:"Negative Binomial"})))))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{style:{padding:10}},r.createElement(p.Z,{variant:"overline"},"9. Diagnosis rate"),r.createElement(A.Z,{container:!0},r.createElement(A.Z,{item:!0,xs:6},"Extra rate due to non-AIDS symptoms"),r.createElement(A.Z,{item:!0,xs:6},r.createElement(ye.Z,{style:{width:"100%",fontSize:"0.75rem"},value:t.modelMgr.delta4Fac,onChange:e=>t.modelMgr.setDelta4Fac(e.target.value),type:"number"}))))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{style:{padding:10}},r.createElement(p.Z,{variant:"overline"},"10. Country-specific settings"),r.createElement(A.Z,{container:!0},r.createElement(A.Z,{item:!0,xs:6},"Country"),r.createElement(A.Z,{item:!0,xs:6},r.createElement(de.Z,{value:t.modelMgr.country,onChange:e=>t.modelMgr.setCountry(e.target.value),style:{width:"100%",fontSize:"0.75rem"}},r.createElement(ge.Z,{value:"OTHER",dense:!0},"Other"),r.createElement(ge.Z,{value:"NL",dense:!0},"NL"))))))))})),It=e=>r.createElement(W,null,r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{display:"flex",justifyContent:"flex-end"},r.createElement(Y.Z,{size:"small",color:"primary"},"Next step"))),r.createElement(A.Z,{item:!0,xs:3},r.createElement(p.Z,{color:"textSecondary"},"Advanced paramaters")),r.createElement(A.Z,{item:!0,xs:9},r.createElement(Pt,e))));var At=e=>{var{progress:t}=e;return null===t?null:r.createElement(X.Z,{color:"secondary",variant:"determinate",value:t})};const Ft=(0,i.Pi)((e=>{var{appMgr:t}=e;return r.createElement(W,null,r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{display:"flex",justifyContent:"flex-end"},r.createElement(Y.Z,{size:"small",color:"primary"},"Next step"))),r.createElement(A.Z,{item:!0,xs:3},r.createElement(p.Z,{color:"textSecondary"},"Perform main fit of HIV model"),r.createElement(pe.Z,{style:{width:"100%",marginTop:20}},r.createElement(de.Z,{value:t.popCombMgr.selectedCombinationName,onChange:e=>{t.popCombMgr.setSelectedCombinationName(e.target.value)},style:{width:"100%",fontSize:"0.75rem"}},t.popCombMgr.combinationsNames.map(((e,t)=>r.createElement(ge.Z,{key:t,value:e,dense:!0},e)))),r.createElement(he.Z,null,"Select population")),r.createElement(pe.Z,{style:{width:"100%",marginTop:20,marginBottom:20}},r.createElement(de.Z,{value:t.modelMgr.timeIntCollMgr.selectedRunCollectionId,onChange:e=>{t.modelMgr.timeIntCollMgr.setSelectedRunCollectionId(e.target.value)},style:{width:"100%",fontSize:"0.75rem"}},t.modelMgr.timeIntCollMgr.collectionsArray.map(((e,t)=>r.createElement(ge.Z,{key:t,value:e.id,dense:!0},e.name)))),r.createElement(he.Z,null,"Select time intervals and diagnosis rates modelling matrix")),r.createElement(K,{onClick:()=>{t.modelMgr.runModels()},disabled:t.modelMgr.modelsRunInProgress}," Run main model"),r.createElement(Y.Z,{onClick:()=>{t.modelMgr.cancelModels()},color:"primary",style:{marginLeft:20},disabled:!t.modelMgr.modelsRunInProgress},"Cancel"),r.createElement(At,{progress:t.modelMgr.modelsRunProgress})),r.createElement(A.Z,{item:!0,xs:9},r.createElement(_.Z,{style:{padding:10}},r.createElement(p.Z,{variant:"overline"},"Run log"),r.createElement("pre",{dangerouslySetInnerHTML:{__html:t.modelMgr.modelsRunLog},style:{overflowX:"auto"}})))))}));var Nt=(0,d.Z)({btRoot:{marginTop:20,marginBottom:20,width:"100%"},btOption:{"& span":{fontSize:"0.75rem"}}}),Rt=e=>{var{progress:t}=e;return null===t?null:r.createElement(X.Z,{color:"secondary",variant:"determinate",value:t})};const Tt=(0,i.Pi)((e=>{var{appMgr:t}=e,a=Nt();return r.createElement(W,null,r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{display:"flex",justifyContent:"flex-end"},r.createElement(Y.Z,{size:"small",color:"primary"},"Next step"))),r.createElement(A.Z,{item:!0,xs:3},r.createElement(p.Z,{color:"textSecondary"},"Perform bootstrap fit of HIV model"),r.createElement(pe.Z,{style:{width:"100%",marginTop:20}},r.createElement(ye.Z,{style:{width:"100%",fontSize:"0.75rem"},value:t.modelMgr.bootstrapCount,onChange:e=>t.modelMgr.setBootstrapCount(e.target.value),type:"number"}),r.createElement(he.Z,null,"Set the number of iterations")),r.createElement(pe.Z,{className:a.btRoot},r.createElement(qe.Z,{row:!0,value:t.modelMgr.bootstrapType,onChange:e=>t.modelMgr.setBootstrapType(e.target.value)},r.createElement(Fe.Z,{value:"NON-PARAMETRIC",control:r.createElement(Je.Z,{color:"primary"}),label:"Non-parametric",className:a.btOption}),r.createElement(Fe.Z,{value:"PARAMETRIC",control:r.createElement(Je.Z,{color:"primary"}),label:"Parametric",className:a.btOption})),r.createElement(he.Z,null,"Set the bootstrap type")),r.createElement(K,{onClick:()=>t.modelMgr.runBootstrap()},r.createElement(ut.Z,null)," Run bootstrap"),r.createElement(Y.Z,{onClick:()=>t.modelMgr.cancelBootstrap(),color:"primary",style:{marginLeft:20}},"Cancel"),r.createElement(Rt,{progress:t.modelMgr.bootstrapRunProgress})),r.createElement(A.Z,{item:!0,xs:9},r.createElement(_.Z,{style:{padding:10}},r.createElement(p.Z,{variant:"overline"},"Run log"),r.createElement("pre",{dangerouslySetInnerHTML:{__html:t.modelMgr.bootstrapRunLog},style:{overflowX:"auto"}})))))})),jt=(0,i.Pi)((e=>{var t=Ge;return r.createElement(W,null,r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{display:"flex",justifyContent:"flex-end"},r.createElement(Y.Z,{size:"small",color:"primary"},"Next step"))),r.createElement(A.Z,{item:!0,xs:3},r.createElement(p.Z,{color:"textSecondary"},"HIV Modelling results"),r.createElement(pe.Z,{component:"fieldset"},r.createElement(qe.Z,{name:"repDelDataSelection",defaultValue:"INDIVIDUAL"},r.createElement(Fe.Z,{value:"INDIVIDUAL",control:r.createElement(Je.Z,{color:"primary",size:"small"}),label:"Individual"}),r.createElement(Fe.Z,{value:"COMBINED",control:r.createElement(Je.Z,{color:"primary",size:"small"}),label:"Combined"})))),r.createElement(A.Z,{item:!0,xs:9},r.createElement(_.Z,{style:{padding:10}},r.createElement(Re.Z,{options:t,series:[{data:[[1980,1],[1981,15],[1982,56]]},{data:[[1980,15],[1981,5],[1982,45]]}],type:"area",height:400})))))})),wt=(0,i.Pi)((e=>{var{appMgr:t}=e,a=t.uiStateMgr.activeSubPageId;return r.createElement(r.Fragment,null,0===a&&r.createElement(bt,e),1===a&&r.createElement(xt,e),2===a&&r.createElement(It,e),3===a&&r.createElement(Ft,e),4===a&&r.createElement(Tt,e),5===a&&r.createElement(jt,e))}));var Yt=(0,d.Z)((()=>({root:{marginTop:10,marginBottom:10,height:10}}))),Ot=e=>{var{progress:t}=e;if(!t)return null;var a=Yt();return r.createElement(X.Z,{color:"secondary",className:a.root})};const kt=(0,i.Pi)((e=>{var{appMgr:t}=e,a=["reportHTML","reportPDF","reportLATEX","reportWORD"];return r.useEffect((()=>(t.unbindShiny(a),t.bindShiny(),()=>t.unbindShiny(a)))),r.createElement(W,null,r.createElement(A.Z,{container:!0,spacing:2},r.createElement(A.Z,{item:!0,xs:12},r.createElement(h.Z,{display:"flex",justifyContent:"flex-end"},r.createElement(Y.Z,{size:"small",color:"primary",disabled:!t.uiStateMgr.outputsPageEnabled,onClick:e=>t.uiStateMgr.setActivePageId(6)},"Next step"))),r.createElement(A.Z,{item:!0,xs:12},r.createElement(p.Z,{variant:"h6"},"Select report")),r.createElement(A.Z,{item:!0,xs:2},r.createElement(pe.Z,{style:{width:"100%",marginTop:20,marginBottom:20}},r.createElement(de.Z,{value:1,style:{width:"100%",fontSize:"0.75rem"}},r.createElement(ge.Z,{value:1,dense:!0},"Report on adjusted data")),r.createElement(he.Z,null,"Select report type")),r.createElement(K,{onClick:e=>t.reportMgr.createReport(),disabled:t.reportMgr.creatingReportInProgress},"Create report"),r.createElement(Y.Z,{onClick:()=>t.reportMgr.cancelCreatingReport(),color:"primary",style:{marginLeft:20},disabled:!t.reportMgr.creatingReportInProgress},"Cancel"),r.createElement(Ot,{progress:t.reportMgr.creatingReportInProgress})),r.createElement(A.Z,{item:!0,xs:10},r.createElement(_.Z,{style:{padding:10}},r.createElement(p.Z,{variant:"overline"},"Report on adjusted data parameters"),r.createElement(rt.Z,null,r.createElement(Fe.Z,{control:r.createElement(ue.Z,{checked:t.reportMgr.adjustReportParams.reportingDelay,onChange:(e,a)=>t.reportMgr.setAdjustReportReportingDelay(a),color:"primary"}),label:"Adjust count of cases for reporting delay"}),r.createElement(Fe.Z,{control:r.createElement(ue.Z,{checked:t.reportMgr.adjustReportParams.smoothing,onChange:(e,a)=>t.reportMgr.setAdjustReportSmoothing(a),color:"primary"}),label:"Apply plot curves smoothing"}),r.createElement(Fe.Z,{control:r.createElement(ue.Z,{checked:t.reportMgr.adjustReportParams.cd4ConfInt,onChange:(e,a)=>t.reportMgr.setAdjustReportCD4ConfInt(a),color:"primary"}),label:"Plot inter-quartile range in CD4 count plots"})),r.createElement(Y.Z,{color:"primary",onClick:e=>t.reportMgr.restoreDefaults()},"Restore defaults"))),t.reportMgr.report&&r.createElement(r.Fragment,null,r.createElement(A.Z,{item:!0,xs:12},r.createElement(L.Z,{light:!0,style:{margin:"30px 0"}})),r.createElement(A.Z,{item:!0,xs:12},r.createElement(p.Z,{variant:"h6"},"View and download")),r.createElement(A.Z,{item:!0,xs:2},r.createElement(P.Z,{href:"#",id:"reportHTML",className:"shiny-download-link"},"HTML"),r.createElement(P.Z,{href:"#",id:"reportPDF",className:"shiny-download-link",style:{marginLeft:10}},"PDF"),r.createElement(P.Z,{href:"#",id:"reportLATEX",className:"shiny-download-link",style:{marginLeft:10}},"Latex"),r.createElement(P.Z,{href:"#",id:"reportWORD",className:"shiny-download-link",style:{marginLeft:10}},"MS Word")),r.createElement(A.Z,{item:!0,xs:10},r.createElement(_.Z,{style:{padding:10}},r.createElement("div",{dangerouslySetInnerHTML:{__html:t.reportMgr.report},style:{overflowX:"auto"}}))))))})),Lt=(0,i.Pi)((e=>{var{appMgr:t}=e,a=["downAdjDataCSV","downAdjDataRDS","downAdjDataDTA"];return r.useEffect((()=>(t.unbindShiny(a),t.bindShiny(),()=>t.unbindShiny(a)))),r.createElement(W,null,r.createElement(A.Z,{container:!0,spacing:2,style:{paddingTop:43}},r.createElement(A.Z,{item:!0,xs:12},r.createElement(p.Z,{variant:"h6"},"Outputs")),r.createElement(A.Z,{item:!0,xs:2},"Adjustments"),r.createElement(A.Z,{item:!0,xs:10},r.createElement(_.Z,{style:{padding:10}},r.createElement(V.Z,null,r.createElement(ce.Z,null,r.createElement(H.Z,null,r.createElement(z.Z,null,"Description"),r.createElement(z.Z,null,"Created"),r.createElement(z.Z,null,"Format"))),r.createElement(U.Z,null,r.createElement(H.Z,null,r.createElement(z.Z,null,"Adjusted case-based data"),r.createElement(z.Z,null,(new Date).toLocaleString()),r.createElement(z.Z,null,r.createElement(P.Z,{href:"#",id:"downAdjDataCSV",className:"shiny-download-link"},"csv (text)")," | ",r.createElement(P.Z,{href:"#",id:"downAdjDataRDS",className:"shiny-download-link"},"rds (R)")," | ",r.createElement(P.Z,{href:"#",id:"downAdjDataDTA",className:"shiny-download-link"},"dta (Stata)")))))))))}));var Bt=a(2607),Wt=a(1982),Gt=["DEAD","AIDS"];const Vt=(0,i.Pi)((e=>{var{notificationsMgr:t}=e,a=(e,a)=>{"clickaway"!==a&&t.clearMsg()};return r.createElement(Bt.Z,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:t.hasMsg,autoHideDuration:5e3,onClose:a,message:t.msgInfo.msg,action:r.createElement(r.Fragment,null,r.createElement(E.Z,{size:"small","aria-label":"close",color:"inherit",onClick:a},r.createElement(Wt.Z,{fontSize:"small"})))})}));function Ut(){return(Ut=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var zt=(0,d.Z)({appBar:{padding:3},appName:{color:"white",marginLeft:10},appVersion:{color:"white",marginRight:10},rightNavBtn:{color:"white"}}),Ht=e=>{var{pageId:t,activePageId:a,children:n}=e,i=function(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}(e,["pageId","activePageId","children"]);return r.createElement(p.Z,Ut({component:"div",role:"tabpanel",hidden:a!==t,id:"wrapped-tabpanel-".concat(t),"aria-labelledby":"wrapped-tab-".concat(t),style:{flexGrow:1,overflowY:"scroll"}},i),a===t&&r.createElement(h.Z,{p:2},n))};const _t=(0,i.f3)("appMgr")((0,i.Pi)((e=>{var{appMgr:t}=e,a=zt(),[n,i]=r.useState(!1),s=t.shinyReady?"#69b023":"#f44336",l=r.createElement(u.Z,{position:"static",className:a.appBar,style:{backgroundColor:"".concat(s)}},r.createElement(g.Z,{variant:"dense",disableGutters:!0},r.createElement(p.Z,{variant:"h6",className:a.appName},"HIV Platform"),r.createElement(p.Z,{variant:"subtitle1",className:a.appVersion}," | version ","1.9.40"),r.createElement(h.Z,{flexGrow:1}),r.createElement(p.Z,{variant:"subtitle1",className:a.appVersion},"Engine state: ",t.shinyStateHuman),r.createElement(E.Z,{onClick:()=>i(!n),className:a.rightNavBtn},r.createElement(y.Z,null))));return r.createElement(h.Z,{display:"flex",flexGrow:1,flexDirection:"column",style:{overflow:"hidden"},p:0},r.createElement(I,Ut({},e,{open:n,onClose:()=>i(!1)})),l,r.createElement(h.Z,{display:"flex",flexGrow:1,flexDirection:"row",style:{overflow:"hidden"},p:0},r.createElement(x,{pages:t.uiStateMgr.pages,activePageId:t.uiStateMgr.activePageId,onPageChange:(e,a)=>{t.uiStateMgr.setActivePageId(e,a)}}),r.createElement(Ht,{pageId:0,activePageId:t.uiStateMgr.activePageId},r.createElement(k,e)),r.createElement(Ht,{pageId:1,activePageId:t.uiStateMgr.activePageId},r.createElement(Ie,e)),r.createElement(Ht,{pageId:2,activePageId:t.uiStateMgr.activePageId},r.createElement(et,e)),r.createElement(Ht,{pageId:3,activePageId:t.uiStateMgr.activePageId},r.createElement(Mt,e)),r.createElement(Ht,{pageId:4,activePageId:t.uiStateMgr.activePageId},r.createElement(wt,e)),r.createElement(Ht,{pageId:5,activePageId:t.uiStateMgr.activePageId},r.createElement(kt,e)),r.createElement(Ht,{pageId:6,activePageId:t.uiStateMgr.activePageId},r.createElement(Lt,e))),r.createElement(Vt,{notificationsMgr:t.notificationsMgr}))})));var Qt=(0,m.Z)({typography:{fontSize:12},palette:{primary:{main:"#69b023"},secondary:{main:"#bedfe1"}},overrides:{MuiStepLabel:{label:{color:"black","&$active":{fontWeight:"bold"},"&$completed":{fontWeight:"bold"}},root:{"&$disabled":{"& .MuiStepLabel-label":{color:"rgba(0, 0, 0, 0.5)"}}}},MuiStepIcon:{root:{"& text":{fill:"white"}}},MuiStepConnector:{vertical:{marginLeft:10}},MuiStepContent:{root:{marginLeft:10,"& .MuiTreeItem-label":{padding:6}}},MuiTreeItem:{label:{fontSize:"0.75rem"}},MuiTableRow:{root:{"&:last-child td":{borderBottom:0}}},MuiTableCell:{head:{fontWeight:"bold !important"}},MuiSlider:{marked:{marginBottom:0}},MuiSelect:{root:{paddingLeft:16,paddingBottom:5}}}});const Jt=()=>r.createElement(c.Z,{theme:Qt},r.createElement(r.Fragment,null,r.createElement(o.ZP,null),r.createElement(_t,null)));var qt=a(7388);const $t=(e,t)=>-1!==t.indexOf(e),Kt=e=>(e=>Array.isArray(e))(e)?e:[e];class Xt{constructor(e){var t=this;this.lastEventType=null,this.rootMgr=null,this.completedSteps=null,this.pages=[{title:"Welcome",completed:!1,disabled:!1,subPages:[]},{title:"Input data upload",completed:!1,disabled:!0,subPages:[{title:"Case-based data",disabled:!1},{title:"Aggregated data",disabled:!1}],activeSubStepId:0},{title:"Case-based data summary",completed:!1,disabled:!0,subPages:[]},{title:"Adjustments",completed:!1,disabled:!0,subPages:[{title:"Inputs",disabled:!1},{title:"Run",disabled:!1}],activeSubStepId:0},{title:"Modelling",completed:!1,disabled:!0,subPages:[{title:"Populations",disabled:!1},{title:"Inputs",disabled:!0},{title:"Advanced",disabled:!0},{title:"Run Main Fit",disabled:!0},{title:"Run Bootstrap",disabled:!0},{title:"Tables and charts",disabled:!0}],activeSubStepId:0},{title:"Reports",completed:!1,disabled:!0,subPages:[]},{title:"Outputs",completed:!1,disabled:!0,subPages:[]}],this.activePageId=0,this.setCompletedSteps=e=>{this.completedSteps=Kt(e),this.refreshPagesStatus()},this.setActivePageId=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t.pages[e].disabled?t.rootMgr.notificationsMgr.setMsg("Page this link refers to is not enabled"):(t.pages[e].subPages.length>a&&(t.pages[e].activeSubPageId=a),t.activePageId=e,t.refreshPagesStatus())},this.setSubPageDisabledStatus=(e,t,a)=>{this.pages[e].subPages[t].disabled=a},this.setLastEventType=e=>this.lastEventType=e,this.refreshPagesStatus=()=>{this.pages[0].completed=this.activePageId>0,this.pages[1].completed=this.activePageId>1,this.pages[2].completed=this.activePageId>2,this.pages[3].completed=this.activePageId>3,this.pages[1].disabled=!this.uploadPageEnabled,this.pages[2].disabled=!this.summaryPageEnabled,this.pages[3].disabled=!this.adjustmentsPageEnabled,this.pages[4].disabled=!this.modellingPageEnabled,this.pages[5].disabled=!this.reportsPageEnabled,this.pages[6].disabled=!this.outputsPageEnabled},this.rootMgr=e,(0,qt.rC)(this,{completedSteps:qt.LO,setCompletedSteps:qt.aD,pages:qt.LO,pagesTitles:qt.Fl,activePageId:qt.LO,setActivePageId:qt.aD,setSubPageDisabledStatus:qt.aD,lastEventType:qt.LO,setLastEventType:qt.aD,uploadPageEnabled:qt.Fl,summaryPageEnabled:qt.Fl,adjustmentsPageEnabled:qt.Fl,modellingPageEnabled:qt.Fl,reportsPageEnabled:qt.Fl,outputsPageEnabled:qt.Fl,caseBasedAttrMappingEnabled:qt.Fl,caseBasedOrigGroupingEnabled:qt.Fl})}get pagesTitles(){return this.pages.map((e=>e.title))}get activeSubPageId(){return this.pages[this.activePageId].activeSubPageId}get uploadPageEnabled(){return $t("SESSION_INITIALIZED",this.completedSteps)}get summaryPageEnabled(){return $t("CASE_BASED_SUMMARY",this.completedSteps)}get adjustmentsPageEnabled(){return $t("CASE_BASED_ORIGIN_GROUPING",this.completedSteps)}get modellingPageEnabled(){return $t("CASE_BASED_ORIGIN_GROUPING",this.completedSteps)||$t("AGGR_READ",this.completedSteps)}get reportsPageEnabled(){return $t("CASE_BASED_ADJUSTMENTS",this.completedSteps)}get outputsPageEnabled(){return $t("CASE_BASED_ADJUSTMENTS",this.completedSteps)}get caseBasedAttrMappingEnabled(){return $t("CASE_BASED_READ",this.completedSteps)}get caseBasedOrigGroupingEnabled(){return $t("CASE_BASED_ATTR_MAPPING",this.completedSteps)}}const ea=e=>{var t=("000000"+(2176782336*Math.random()<<0).toString(36)).slice(-6);return"".concat(e,"_").concat(t)};class ta{constructor(e){this.rootMgr=null,this.msgInfo={key:null,msg:null},this.setMsg=e=>{this.msgInfo={msg:e,key:ea("msg")}},this.clearMsg=()=>{this.msgInfo={key:null,msg:null}},this.rootMgr=e,(0,qt.rC)(this,{msgInfo:qt.LO,setMsg:qt.aD,clearMsg:qt.aD,hasMsg:qt.Fl})}get hasMsg(){return null!==this.msgInfo.msg}}class aa{constructor(e){this.rootMgr=null,this.mapping=[],this.actionStatus=null,this.actionMessage=null,this.setMapping=e=>{this.mapping=e,this.runCheck()},this.setActionStatus=e=>this.actionStatus=e,this.setActionMessage=e=>this.actionMessage=e,this.setOrigCol=(e,t)=>{var a=this.mapping.findIndex((t=>t.attribute===e));-1!==a?(this.mapping[a].origColName=""!==t?t:null,this.runCheck()):console.log('AttrMappingManager.setOrigCol: cannot find element with Attribute "'.concat(e,'"'))},this.setDefVal=(e,t)=>{var a=this.mapping.findIndex((t=>t.attribute===e));-1!==a?(this.mapping[a].defaultValue=""!==t?t:null,this.runCheck()):console.log('AttrMappingManager.setDefVal: cannot find element with Attribute "'.concat(e,'"'))},this.applyMapping=()=>{this.rootMgr.btnClicked("attrMapping:AttrMappingArray",this.mapping)},this.runCheck=()=>{var e=[...this.mapping.filter((e=>e.origColName)).map((e=>e.origColName)).reduce(((e,t)=>e.set(t,(e.get(t)||0)+1)),new Map)].filter((e=>e[1]>1)).map((e=>e[0])),t=null,a=null;e.length>0?(a="FAIL",t="Column".concat(e.length>1?"s":"",' "').concat(e.join(", "),'" ').concat(e.length>1?"are":"is"," mapped multiple times")):(a="SUCCESS",t="Attribute mapping is valid"),this.setActionStatus(a),this.setActionMessage(t)},this.rootMgr=e,(0,qt.rC)(this,{mapping:qt.LO,actionStatus:qt.LO,actionMessage:qt.LO,setMapping:qt.aD,setOrigCol:qt.aD,setDefVal:qt.aD,applyMapping:qt.aD,setActionStatus:qt.aD,setActionMessage:qt.aD,actionValid:qt.Fl})}get actionValid(){return ee(this.actionStatus)?null:"SUCCESS"===this.actionStatus}}const ra=(e,t)=>(t=Kt(t),e.filter(((e,a)=>-1===t.indexOf(a))));class na{constructor(e){this.rootMgr=null,this.distribution={origin:[],count:[]},this.groupings=[],this.type="REPCOUNTRY + UNK + OTHER",this.actionStatus=null,this.actionMessage=null,this.setDistribution=e=>this.distribution=e,this.setGroupings=e=>{var t=e.map((e=>{var t=Array.isArray(e.origin)?e.origin:[e.origin];return{name:e.name,origin:t,groupCount:0}}));this.groupings=t,this.computeGroupCounts()},this.setType=e=>this.type=e,this.setActionStatus=e=>this.actionStatus=e,this.setActionMessage=e=>this.actionMessage=e,this.setGroupName=(e,t)=>{this.groupings[e].name=t,this.type="Custom"},this.setGroupOrigin=(e,t)=>{this.groupings[e].origin=t,this.computeGroupCounts(),this.type="Custom"},this.removeGroupings=e=>{this.groupings=ra(this.groupings,e),this.computeGroupCounts(),this.type="Custom"},this.addEmptyGrouping=()=>{this.groupings.push({name:"New",groupeCount:0,origin:[]}),this.computeGroupCounts(),this.type="Custom"},this.applyGroupings=()=>{this.rootMgr.btnClicked("originGrouping:OriginGroupingArray",this.groupings)},this.computeGroupCounts=()=>{this.groupings.forEach((e=>{var t=e.origin.reduce(((e,t)=>{var a=this.distributionArray.findIndex((e=>e.origin==t));return-1!==a?e+this.distributionArray[a].count:e}),0);e.groupCount=t}))},this.rootMgr=e,(0,qt.rC)(this,{distribution:qt.LO,groupings:qt.LO,type:qt.LO,actionStatus:qt.LO,actionMessage:qt.LO,distributionArray:qt.Fl,origins:qt.Fl,usedOrigins:qt.Fl,unusedOrigins:qt.Fl,groupingsJS:qt.Fl,setDistribution:qt.aD,setGroupings:qt.aD,setType:qt.aD,setGroupName:qt.aD,setGroupOrigin:qt.aD,removeGroupings:qt.aD,addEmptyGrouping:qt.aD,applyGroupings:qt.aD,setActionStatus:qt.aD,setActionMessage:qt.aD,actionValid:qt.Fl})}get distributionArray(){var e=this.distribution.origin,t=this.distribution.count;return e.map(((a,r)=>({origin:e[r],count:t[r]})))}get origins(){return this.distribution.origin.slice().sort()}get usedOrigins(){return[].concat.apply([],this.groupings.map((e=>e.origin)))}get unusedOrigins(){return this.origins.filter((e=>!this.usedOrigins.includes(e)))}get groupingsJS(){return(0,qt.ZN)(this.groupings)}get actionValid(){return ee(this.actionStatus)?null:"SUCCESS"===this.actionStatus}}var ia=function(e){this.files=e,this.fileIndex=-1,this.aborted=!1,this.completed=!1,this.$run()};function sa(e,t,a){var r,n;r=$(t),(n=r.data("currentUploader"))&&n.abort(),r.removeAttr("data-restore");var i=t.files;0!==i.length&&(this.shinyapp=e,this.id=t.id,this.el=t,this.progressCallback=a,ia.call(this,i))}(function(){this.onBegin=function(e,t){setTimeout(t,0)},this.onFile=function(e,t){setTimeout(t,0)},this.onComplete=function(){},this.onAbort=function(){},this.abort=function(){this.completed||this.aborted||(this.aborted=!0,this.onAbort())},this.$getRun=function(){var e=this,t=!1;return function(){t||(t=!0,e.$run())}},this.$run=function(){if(!this.aborted&&!this.completed){if(this.fileIndex<0)return this.fileIndex=0,void this.onBegin(this.files,this.$getRun());if(this.fileIndex===this.files.length)return this.completed=!0,void this.onComplete();var e=this.files[this.fileIndex++];this.onFile(e,this.$getRun())}}}).call(ia.prototype),$.extend(sa.prototype,ia.prototype),function(){this.makeRequest=function(e,t,a,r,n){this.shinyapp.makeRequest(e,t,a,r,n)},this.onBegin=function(e,t){var a=this;this.onProgress(0),this.totalBytes=0,this.progressBytes=0,$.each(e,(function(e,t){a.totalBytes+=t.size}));var r=$.map(e,(function(e){return{name:e.name,size:e.size,type:e.type}}));this.makeRequest("uploadInit",[r],(function(e){a.jobId=e.jobId,a.uploadUrl=e.uploadUrl,t()}),(function(e){a.onError(e)}))},this.onFile=function(e,t){var a=this;this.onProgress(0),$.ajax(this.uploadUrl,{type:"POST",cache:!1,xhr:function(){var e=$.ajaxSettings.xhr();return e.upload&&(e.upload.onprogress=function(e){e.lengthComputable&&a.onProgress((a.progressBytes+e.loaded)/a.totalBytes)}),e},data:e,contentType:"application/octet-stream",processData:!1,success:function(){a.progressBytes+=e.size,t()},error:function(e,t){a.onError(e.responseText||t)}})},this.onComplete=function(){var e=this,t=$.map(this.files,(function(e){return{name:e.name,size:e.size,type:e.type}})),a=jQuery.Event("shiny:inputchanged");a.name=this.id,a.value=t,a.el=this.el,a.inputType="shiny.fileupload",$(document).trigger(a),this.makeRequest("uploadEnd",[this.jobId,this.id],(function(){e.onProgress(null)}),(function(t){e.onError(t)}))},this.onError=function(e){console.log("onError: ",e),this.progressCallback(null)},this.onAbort=function(){console.log("onAbort"),this.progressCallback(null)},this.onProgress=function(e){this.progressCallback(e)}}.call(sa.prototype);class la{constructor(e){this.rootMgr=null,this.fileName=null,this.fileSize=null,this.fileType=null,this.filePath=null,this.columnNames=[],this.recordCount=null,this.uploadProgress=null,this.actionStatus=null,this.actionMessage=null,this.setFileName=e=>this.fileName=e,this.setFileSize=e=>this.fileSize=e,this.setFileType=e=>this.fileType=e,this.setFilePath=e=>this.filePath=e,this.setRecordCount=e=>this.recordCount=e,this.setColumnNames=e=>this.columnNames=Kt(e),this.setUploadProgress=e=>this.uploadProgress=e,this.setActionStatus=e=>this.actionStatus=e,this.setActionMessage=e=>this.actionMessage=e,this.uploadData=e=>{$(e).data("currentUploader",new sa(Shiny.shinyapp,e,this.setUploadProgress))},this.rootMgr=e,(0,qt.rC)(this,{fileName:qt.LO,fileSize:qt.LO,fileType:qt.LO,filePath:qt.LO,columnNames:qt.LO,recordCount:qt.LO,uploadProgress:qt.LO,actionStatus:qt.LO,actionMessage:qt.LO,setFileName:qt.aD,setFileSize:qt.aD,setFileType:qt.aD,setFilePath:qt.aD,setRecordCount:qt.aD,setColumnNames:qt.aD,setColumnNames:qt.aD,uploadData:qt.aD,setUploadProgress:qt.aD,setActionStatus:qt.aD,setActionMessage:qt.aD,columnNamesString:qt.Fl,actionValid:qt.Fl})}get columnNamesString(){return null===this.columnNames?"":this.columnNames.join(", ")}get actionValid(){return ee(this.actionStatus)?null:"SUCCESS"===this.actionStatus}}class oa{constructor(e){this.rootMgr=null,this.fileName=null,this.fileSize=null,this.fileType=null,this.filePath=null,this.dataFiles=[],this.dataFileNameToIdxMap=new Map,this.populationNames=[],this.fileUploadProgress=null,this.actionStatus=null,this.actionMessage=null,this.setFileName=e=>this.fileName=e,this.setFileSize=e=>this.fileSize=e,this.setFileType=e=>this.fileType=e,this.setFilePath=e=>this.filePath=e,this.setDataFiles=e=>{this.dataFiles=Kt(e),this.dataFileNameToIdxMap=new Map(this.dataFiles.map(((e,t)=>[e.name,t])));var t=Math.min.apply(1/0,this.dataFilesGrouped.map((e=>e.years[0]))),a=Math.max.apply(-1/0,this.dataFilesGrouped.map((e=>e.years[1])));this.setDataFileYears("GROUPED",[t,a])},this.setDataFileUse=(e,t)=>this.dataFiles[this.dataFileNameToIdxMap.get(e)].use=t,this.setDataFileYears=(e,t)=>{this.dataNamesNonGrouped.includes(e)?this.dataFiles[this.dataFileNameToIdxMap.get(e)].years=t:this.dataFilesGrouped.forEach((e=>e.years=t))},this.setPopulationNames=e=>this.populationNames=Kt(e).sort(),this.setFileUploadProgress=e=>this.fileUploadProgress=e,this.uploadData=e=>{$(e).data("currentUploader",new sa(Shiny.shinyapp,e,this.setFileUploadProgress))},this.setActionStatus=e=>this.actionStatus=e,this.setActionMessage=e=>this.actionMessage=e,this.rootMgr=e,(0,qt.rC)(this,{fileName:qt.LO,fileSize:qt.LO,fileType:qt.LO,filePath:qt.LO,populationNames:qt.LO,fileUploadProgress:qt.LO,dataFiles:qt.LO,actionStatus:qt.LO,actionMessage:qt.LO,dataFilesGrouped:qt.Fl,dataFilesNonGrouped:qt.Fl,dataNames:qt.Fl,dataNamesGrouped:qt.Fl,dataNamesNonGrouped:qt.Fl,dataNamesString:qt.Fl,populationNamesString:qt.Fl,setFileName:qt.aD,setFileSize:qt.aD,setFileType:qt.aD,setFilePath:qt.aD,setDataFiles:qt.aD,setDataFileUse:qt.aD,setDataFileYears:qt.aD,setPopulationNames:qt.aD,setFileUploadProgress:qt.aD,uploadData:qt.aD,setActionStatus:qt.aD,setActionMessage:qt.aD,actionValid:qt.Fl})}get dataFilesNonGrouped(){return this.dataFiles.filter((e=>Gt.includes(e.name.toUpperCase())))}get dataFilesGrouped(){return this.dataFiles.filter((e=>!Gt.includes(e.name.toUpperCase())))}get dataNames(){return this.dataFiles.map((e=>e.name))}get dataNamesGrouped(){return this.dataFilesGrouped.map((e=>e.name))}get dataNamesNonGrouped(){return this.dataFilesNonGrouped.map((e=>e.name))}get dataNamesString(){return null===this.dataNames?"":this.dataNames.join(", ")}get populationNamesString(){return null===this.populationNames?"":this.populationNames.join(", ")}get actionValid(){return ee(this.actionStatus)?null:"SUCCESS"===this.actionStatus}}class ma{constructor(e){this.rootMgr=null,this.selectedCount=null,this.totalCount=null,this.diagYearPlotData={filter:{scaleMinYear:null,scaleMaxYear:null,valueMinYear:null,valueMaxYear:null,applyInAdjustments:!1},chartCategories:[],chartData:[]},this.notifQuarterPlotData={filter:{scaleMinYear:null,scaleMaxYear:null,valueMinYear:null,valueMaxYear:null,applyInAdjustments:!1},chartCategories:[],chartData:[]},this.missPlotData={plot1:{chartCategories:[],chartData:{all:[],female:[],male:[]}},plot2:{chartCategories:[],chartData:{all:[],female:[],male:[]}},plot3:{chartData:{all:[],female:[],male:[]}},plot4:{chartCategories:[],chartData:{all:[],female:[],male:[]}}},this.missPlotSelection="all",this.repDelPlotData={chartData:{all:{q95:0,series:[]},female:{q95:0,series:[]},male:{q95:0,series:[]}}},this.repDelPlotSelection="all",this.setSelectedCount=e=>this.selectedCount=e,this.setTotalCount=e=>this.totalCount=e,this.setDiagYearPlotData=e=>this.diagYearPlotData=e,this.setDiagYearFilterApply=e=>this.diagYearPlotData.filter.applyInAdjustments=e,this.setDiagYearFilterMinYear=e=>{this.diagYearPlotData.filter.valueMinYear!==e&&(this.diagYearPlotData.filter.valueMinYear=e)},this.setDiagYearFilterMaxYear=e=>{this.diagYearPlotData.filter.valueMaxYear!==e&&(this.diagYearPlotData.filter.valueMaxYear=e)},this.setNotifQuarterPlotData=e=>this.notifQuarterPlotData=e,this.setNotifQuarterFilterApply=e=>this.notifQuarterPlotData.filter.applyInAdjustments=e,this.setNotifQuarterFilterMinYear=e=>{this.notifQuarterPlotData.filter.valueMinYear!==e&&(this.notifQuarterPlotData.filter.valueMinYear=e)},this.setNotifQuarterFilterMaxYear=e=>{this.notifQuarterPlotData.filter.valueMaxYear!==e&&(this.notifQuarterPlotData.filter.valueMaxYear=e)},this.setMissPlotData=e=>this.missPlotData=e,this.setMissPlotSelection=e=>this.missPlotSelection=e,this.setRepDelPlotData=e=>this.repDelPlotData=e,this.setRepDelPlotSelection=e=>this.repDelPlotSelection=e,this.reset=()=>{this.selectedCount=null,this.totalCount=null,this.diagYearPlotData={filter:{scaleMinYear:null,scaleMaxYear:null,valueMinYear:null,valueMaxYear:null,applyInAdjustments:!1},chartCategories:[],chartData:[]},this.notifQuarterPlotData={filter:{scaleMinYear:null,scaleMaxYear:null,valueMinYear:null,valueMaxYear:null,applyInAdjustments:!1},chartCategories:[],chartData:[]},this.missPlotData={plot1:{chartCategories:[],chartData:{all:[],female:[],male:[]}},plot2:{chartCategories:[],chartData:{all:[],female:[],male:[]}},plot3:{chartData:{all:[],female:[],male:[]}},plot4:{chartCategories:[],chartData:{all:[],female:[],male:[]}}},this.missPlotSelection="all",this.repDelPlotData={chartData:{all:{q95:0,series:[]},female:{q95:0,series:[]},male:{q95:0,series:[]}}},this.repDelPlotSelection="all"},this.rootMgr=e,(0,qt.rC)(this,{selectedCount:qt.LO,totalCount:qt.LO,diagYearPlotData:qt.LO,notifQuarterPlotData:qt.LO,missPlotData:qt.LO,missPlotSelection:qt.LO,repDelPlotData:qt.LO,repDelPlotSelection:qt.LO,reset:qt.aD,setSelectedCount:qt.aD,setTotalCount:qt.aD,setDiagYearPlotData:qt.aD,setDiagYearFilterApply:qt.aD,setDiagYearFilterMinYear:qt.aD,setDiagYearFilterMaxYear:qt.aD,setNotifQuarterPlotData:qt.aD,setNotifQuarterFilterApply:qt.aD,setNotifQuarterFilterMinYear:qt.aD,setNotifQuarterFilterMaxYear:qt.aD,setMissPlotData:qt.aD,setMissPlotSelection:qt.aD,setRepDelPlotData:qt.aD,setRepDelPlotSelection:qt.aD,notifQuarterSliderMarks:qt.Fl,notifQuarterChartCategories:qt.Fl,missPlot1Series:qt.Fl,missPlot2Series:qt.Fl,missPlot3Series:qt.Fl,missPlot4Series:qt.Fl,repDelPlot:qt.Fl,missPlot3Categories:qt.Fl,missPlot4Categories:qt.Fl,filters:qt.Fl}),(0,qt.EH)((()=>{this.rootMgr.inputValueSet("summaryFilters",this.filters)}),{delay:1e3})}get notifQuarterSliderMarks(){return this.notifQuarterPlotData.chartCategories.map((e=>({value:e,label:""})))}get notifQuarterChartCategories(){return this.notifQuarterPlotData.chartCategories.map((e=>He(e)))}get missPlot1Series(){return[{name:"Missingness",data:this.missPlotData.plot1.chartData[this.missPlotSelection]}]}get missPlot2Series(){return this.missPlotData.plot2.chartData[this.missPlotSelection].map(((e,t)=>({name:"Combination ".concat(t+1),data:e.map(((e,t)=>({x:this.missPlotData.plot2.chartCategories[t],y:e})))})))}get missPlot3Series(){return["Present","Missing"].map((e=>({name:e,data:this.missPlotData.plot3.chartData[this.missPlotSelection].map(((t,a)=>({x:"Combination ".concat(a+1),y:t.name===e?t.y:0})))})))}get missPlot4Series(){return this.missPlotData.plot4.chartData[this.missPlotSelection]}get repDelPlot(){var e=(0,qt.ZN)(this.repDelPlotData.chartData[this.repDelPlotSelection]);return{q95:e.q95,series:[{name:"density",data:e.series}]}}get missPlot3Categories(){return this.missPlotData.plot3.chartData[this.missPlotSelection].map((e=>"".concat((100*e.y).toFixed(2)," %")))}get missPlot4Categories(){return this.missPlotData.plot4.chartCategories}get filters(){return{DiagYear:{ApplyInAdjustments:this.diagYearPlotData.filter.applyInAdjustments,MinYear:this.diagYearPlotData.filter.valueMinYear,MaxYear:this.diagYearPlotData.filter.valueMaxYear},NotifQuarter:{ApplyInAdjustments:this.notifQuarterPlotData.filter.applyInAdjustments,MinYear:this.notifQuarterPlotData.filter.valueMinYear,MaxYear:this.notifQuarterPlotData.filter.valueMaxYear}}}}class ca{constructor(e){this.rootMgr=null,this.miAdjustType="none",this.miJomoSettings={nimp:5,nburn:1e3,nbetween:500,nsdf:4,imputeRD:!1},this.miMiceSettings={nimp:5,nit:5,nsdf:4,imputeRD:!1},this.rdAdjustType="none",this.dataBounds={startYear:2e3,endYear:2017,endQrt:1},this.rdWithoutTrendSettings={startYear:2e3,endYear:2017,endQrt:1,stratGender:!1,stratTrans:!1,stratMigr:!1},this.rdWithTrendSettings={startYear:2e3,endYear:2017,endQrt:1,stratGender:!1,stratTrans:!1,stratMigr:!1},this.adjustmentsRunProgress=null,this.adjustmentsRunLog=null,this.adjustmentsReport=null,this.setMIAdjustType=e=>this.miAdjustType=e,this.setMIJomoNimp=e=>this.miJomoSettings.nimp=e,this.setMIJomoNburn=e=>this.miJomoSettings.nburn=e,this.setMIJomoNbetween=e=>this.miJomoSettings.nbetween=e,this.setMIJomoNsdf=e=>this.miJomoSettings.nsdf=e,this.setMIJomoImputeRD=e=>this.miJomoSettings.imputeRD=e,this.setMIMiceNimp=e=>this.miMiceSettings.nimp=e,this.setMIMiceNit=e=>this.miMiceSettings.nit=e,this.setMIMiceNsdf=e=>this.miMiceSettings.nsdf=e,this.setMIMiceImputeRD=e=>this.miMiceSettings.imputeRD=e,this.restoreMIDefaults=e=>{"jomo"===e?this.miJomoSettings={nimp:5,nburn:1e3,nbetween:500,nsdf:4,imputeRD:!1}:"mice"===e&&(this.miMiceSettings={nimp:5,nit:5,nsdf:4,imputeRD:!1})},this.setRDAdjustType=e=>this.rdAdjustType=e,this.setRDWithoutStartYear=e=>this.rdWithoutTrendSettings.startYear=e,this.setRDWithoutEndYear=e=>this.rdWithoutTrendSettings.endYear=e,this.setRDWithoutEndQrt=e=>this.rdWithoutTrendSettings.endQrt=e,this.setRDWithoutStratGender=e=>this.rdWithoutTrendSettings.stratGender=e,this.setRDWithoutStratTrans=e=>this.rdWithoutTrendSettings.stratTrans=e,this.setRDWithoutStratMigr=e=>this.rdWithoutTrendSettings.stratMigr=e,this.setRDWithStartYear=e=>this.rdWithTrendSettings.startYear=e,this.setRDWithEndYear=e=>this.rdWithTrendSettings.endYear=e,this.setRDWithEndQrt=e=>this.rdWithTrendSettings.endQrt=e,this.setRDWithStratGender=e=>this.rdWithTrendSettings.stratGender=e,this.setRDWithStratTrans=e=>this.rdWithTrendSettings.stratTrans=e,this.setRDWithStratMigr=e=>this.rdWithTrendSettings.stratMigr=e,this.setDataBounds=e=>this.dataBounds=e,this.restoreRDDefaults=e=>{"withoutTrend"===e?this.rdWithoutTrendSettings={startYear:this.dataBounds.startYear,endYear:this.dataBounds.endYear,endQrt:this.dataBounds.endQrt,stratGender:!1,stratTrans:!1,stratMigr:!1}:"withTrend"===e&&(this.rdWithTrendSettings={startYear:this.dataBounds.startYear,endYear:this.dataBounds.endYear,endQrt:this.dataBounds.endQrt,stratGender:!1,stratTrans:!1,stratMigr:!1})},this.runAdjustments=()=>{this.rootMgr.btnClicked("runAdjustBtn",{Filters:this.rootMgr.summaryDataMgr.filters,MIAdjustType:this.miAdjustType,MIParams:this.miParams,RDAdjustType:this.rdAdjustType,RDParams:this.rdParams})},this.cancelAdjustments=()=>this.rootMgr.btnClicked("cancelAdjustBtn"),this.setAdjustmentsRunProgress=e=>this.adjustmentsRunProgress=e,this.setAdjustmentsRunLog=e=>this.adjustmentsRunLog=e,this.setAdjustmentsReport=e=>this.adjustmentsReport=e,this.rootMgr=e,(0,qt.rC)(this,{miAdjustType:qt.LO,miJomoSettings:qt.LO,miMiceSettings:qt.LO,rdAdjustType:qt.LO,rdWithoutTrendSettings:qt.LO,rdWithTrendSettings:qt.LO,adjustmentsRunProgress:qt.LO,adjustmentsRunLog:qt.LO,adjustmentsReport:qt.LO,miParams:qt.Fl,rdParams:qt.Fl,adjustmentSelected:qt.Fl,adjustmentsRunInProgress:qt.Fl,setMIAdjustType:qt.aD,setRDAdjustType:qt.aD,setMIJomoNimp:qt.aD,setMIJomoNburn:qt.aD,setMIJomoNbetween:qt.aD,setMIJomoNsdf:qt.aD,setMIJomoImputeRD:qt.aD,setMIMiceNimp:qt.aD,setMIMiceNit:qt.aD,setMIMiceNsdf:qt.aD,setMIMiceImputeRD:qt.aD,restoreMIDefaults:qt.aD,restoreRDDefaults:qt.aD,setRDWithoutStartYear:qt.aD,setRDWithoutEndYear:qt.aD,setRDWithoutEndQrt:qt.aD,setRDWithoutStratGender:qt.aD,setRDWithoutStratTrans:qt.aD,setRDWithoutStratMigr:qt.aD,setRDWithStartYear:qt.aD,setRDWithEndYear:qt.aD,setRDWithEndQrt:qt.aD,setRDWithStratGender:qt.aD,setRDWithStratTrans:qt.aD,setRDWithStratMigr:qt.aD,runAdjustments:qt.aD,cancelAdjustments:qt.aD,setAdjustmentsRunProgress:qt.aD,setAdjustmentsRunLog:qt.aD,setAdjustmentsReport:qt.aD,setDataBounds:qt.aD}),(0,qt.EH)((()=>{this.rootMgr.uiStateMgr.setSubPageDisabledStatus(3,1,!this.adjustmentSelected)}))}get miParams(){var e=null;return"jomo"===this.miAdjustType?e=this.miJomoSettings:"mice"===this.miAdjustType&&(e=this.miMiceSettings),e}get rdParams(){var e=null;return"withoutTrend"===this.rdAdjustType?e=this.rdWithoutTrendSettings:"withTrend"===this.rdAdjustType&&(e=this.rdWithTrendSettings),e}get adjustmentSelected(){return"none"!==this.miAdjustType||"none"!==this.rdAdjustType}get adjustmentsRunInProgress(){return null!==this.adjustmentsRunProgress}}class da{constructor(e){this.rootMgr=null,this.availableVariables=[],this.availableStrata={},this.populations=[],this.addEmptyPopulation=()=>{this.populations.push({id:ea("Population"),variables:[],variablesKey:null,strata:[]})},this.setAvailableVariables=e=>{null==e&&(e=[]),this.availableVariables=e,this.populations=[]},this.setAvailableStrata=e=>{null==e&&(e={}),this.availableStrata=e,this.populations=[]},this.removePopulations=e=>{this.populations=ra(this.populations,e)},this.setPopulationVariables=(e,t)=>{var a,r;this.populations[e].variables=(a=this.availableVarNames,r=t,a.filter((e=>-1!==r.indexOf(e)))),this.populations[e].variablesKey=this.populations[e].variables.join(", "),this.populations[e].strata=this.availableStrata[this.populations[e].variablesKey]},this.rootMgr=e,(0,qt.rC)(this,{availableVariables:qt.LO,availableStrata:qt.LO,populations:qt.LO,addEmptyPopulation:qt.aD,removePopulations:qt.aD,setPopulationVariables:qt.aD,setAvailableVariables:qt.aD,setAvailableStrata:qt.aD,populationsJS:qt.Fl,availableVarNames:qt.Fl})}get populationsJS(){return(0,qt.ZN)(this.populations)}get availableVarNames(){return this.availableVariables.map((e=>e.Name))}}const ua=(e,t)=>{var a=Kt(t).map((t=>parseFloat(t.replace(e,""))));return Math.max(0,Math.max.apply(null,a.filter((e=>!isNaN(e)))))+1};class ga{constructor(e){this.parentMgr=null,this.combinations=[],this.selectedCombinationName="",this.addEmptyCombination=()=>{this.combinations.push({name:"Combination ".concat(ua("Combination ",this.combinationsNames)),populations:[],aggrPopulations:[]})},this.removeCombinations=e=>{this.combinations=ra(this.combinations,e)},this.setSelectedCombinationName=e=>{this.selectedCombinationName=e},this.setCombinationName=(e,t)=>{this.combinations[e].name=t},this.setCombinationPopulations=(e,t)=>{this.combinations[e].populations=t},this.setAggrCombinationPopulations=(e,t)=>{this.combinations[e].aggrPopulations=t},this.syncPopulations=e=>{this.combinations.forEach((t=>{t.populations=t.populations.filter((t=>e.includes(t)))}))},this.syncAggrPopulations=e=>{this.combinationAll.forEach((t=>t.aggrPopulations=e))},this.parentMgr=e,(0,qt.rC)(this,{combinations:qt.LO,selectedCombinationName:qt.LO,addEmptyCombination:qt.aD,removeCombinations:qt.aD,setCombinationName:qt.aD,setSelectedCombinationName:qt.aD,setCombinationPopulations:qt.aD,setAggrCombinationPopulations:qt.aD,syncPopulations:qt.aD,syncAggrPopulations:qt.aD,combinationAll:qt.Fl,combinationsJS:qt.Fl,combinationsNames:qt.Fl,aggrCombinationsJS:qt.Fl,selectedCombination:qt.Fl}),this.combinations.push({name:"All",populations:[],aggrPopulations:[]}),this.setSelectedCombinationName("All"),(0,qt.EH)((()=>{this.syncPopulations(this.parentMgr.popMgr.definedPopulations)})),(0,qt.EH)((()=>{this.syncAggrPopulations(this.parentMgr.aggrDataMgr.populationNames)}))}get combinationAll(){return this.combinations.filter((e=>"ALL"===e.name.toUpperCase()))}get combinationsJS(){return(0,qt.ZN)(this.combinations)}get combinationsNames(){return this.combinations.map((e=>e.name))}get aggrCombinationsJS(){return(0,qt.ZN)(this.aggrCombinations)}get selectedCombination(){return this.combinations.filter((e=>e.name===this.selectedCombinationName))[0]}}class pa{constructor(e,t){var a=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.parentMgr=null,this.id=null,this.name="",this.intervals=[],this.minYear=null,this.maxYear=null,this.setId=e=>this.id=e,this.setName=e=>this.name=e,this.setMinYear=e=>{this.minYear=e,this.intervals.forEach((e=>e.startYear=Math.max(this.minYear,e.startYear))),this.reinitializeEndYears()},this.setMaxYear=e=>{this.maxYear=e,this.reinitializeEndYears()},this.setIntervals=(e,t,a)=>{this.minYear=e,this.maxYear=t,this.intervals=a},this.createIntervals=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(r>0){a.minYear=e,a.maxYear=t;for(var i=e,s=0;s<r;++s){var l=i,o=Math.max(Math.floor((t-l)/(r-s)),1),m=Math.min(l+o,t);if(0===s&&n>0&&n>=e&&(l=e,m=n),a.addInterval(l,m,0!==s,!1,!1),i=m,m===t)break}}},this.addEmptyInterval=()=>{this.intervals.push({startYear:this.maxStartYear,endYear:this.maxYear,jump:!1,changeInInterval:!1,diffByCD4:!1}),this.reinitializeEndYears()},this.addInterval=(e,t,a,r,n)=>{this.intervals.push({startYear:e,endYear:t,jump:a,changeInInterval:r,diffByCD4:n})},this.removeIntervals=e=>{e.length===this.intervals.length&&(e=ra(e,0)),this.intervals=ra(this.intervals,e),this.reinitializeEndYears()},this.setIntervalStartYear=(e,t)=>{t>=this.minYear&&t<=this.maxYear&&(this.intervals[e].startYear=t,this.reinitializeEndYears())},this.setIntervalJump=(e,t)=>this.intervals[e].jump=t,this.setIntervalChangeInInterval=(e,t)=>this.intervals[e].changeInInterval=t,this.setIntervalDiffByCD4=(e,t)=>this.intervals[e].diffByCD4=t,this.reinitializeEndYears=()=>{var e=this.intervals.length;if(e>0){this.intervals[0].startYear=this.minYear,this.intervals.sort(((e,t)=>e.startYear<t.startYear?-1:1));for(var t=0;t<e;++t)this.intervals[t].startYear=Math.min(this.intervals[t].startYear,this.maxYear),t!==e-1&&(this.intervals[t].endYear=Math.min(this.intervals[t+1].startYear,this.maxYear));this.intervals[e-1].endYear=this.maxYear}},this.parentMgr=e,this.id=ea("timeIntervals"),this.name=t,this.minYear=e.minYear,this.maxYear=e.maxYear,ee(r)?this.createIntervals(this.minYear,this.maxYear,5):this.intervals=r,(0,qt.rC)(this,{id:qt.LO,name:qt.LO,intervals:qt.LO,minYear:qt.LO,maxYear:qt.LO,setMinYear:qt.aD,setMaxYear:qt.aD,setIntervals:qt.aD,addEmptyInterval:qt.aD,removeIntervals:qt.aD,setId:qt.aD,setName:qt.aD,setIntervalStartYear:qt.aD,setIntervalJump:qt.aD,setIntervalChangeInInterval:qt.aD,setIntervalDiffByCD4:qt.aD,intervalsJS:qt.Fl,maxStartYear:qt.Fl})}get intervalsJS(){return(0,qt.ZN)(this.intervals)}get maxStartYear(){return 0===this.intervals.length?this.minYear:Math.max.apply(null,this.intervals.map((e=>e.startYear)))}}class ha{constructor(e){var t=this;this.parentMgr=null,this.collections=new Map,this.minYear=1980,this.maxYear=2016,this.selectedEditCollectionId=null,this.selectedRunCollectionId=null,this.setMinYear=e=>this.minYear=e,this.setMaxYear=e=>this.maxYear=e,this.addNewCollection=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;ee(e)&&(e=0===t.collections.size?"Default":"Set ".concat(ua("Set ",t.collectionsNames)));var r=new pa(t,e,a);t.collections.set(r.id,r),t.selectedEditCollectionId=r.id},this.deleteSelectedEditCollection=()=>{this.collections.has(this.selectedEditCollectionId)&&this.collections.delete(this.selectedEditCollectionId);var e=(0,qt.XP)(this.collections);this.selectedEditCollectionId=e[e.length-1]},this.setSelectedEditCollectionId=e=>{this.selectedEditCollectionId=e},this.setSelectedRunCollectionId=e=>{this.selectedRunCollectionId=e},this.parentMgr=e,this.minYear=e.minYear,this.maxYear=e.maxYear,this.addNewCollection(),this.selectedRunCollectionId=this.selectedEditCollection.id,(0,qt.rC)(this,{minYear:qt.LO,maxYear:qt.LO,collections:qt.LO,selectedEditCollectionId:qt.LO,selectedRunCollectionId:qt.LO,setMinYear:qt.aD,setMaxYear:qt.aD,addNewCollection:qt.aD,setSelectedEditCollectionId:qt.aD,setSelectedRunCollectionId:qt.aD,deleteSelectedEditCollection:qt.aD,selectedEditCollection:qt.Fl,selectedRunCollection:qt.Fl,collectionsArray:qt.Fl,defaultEditCollectionSelected:qt.Fl,collectionsNames:qt.Fl}),(0,qt.EH)((()=>{this.collections.forEach((e=>e.setMinYear(this.minYear)))})),(0,qt.EH)((()=>{this.collections.forEach((e=>e.setMaxYear(this.maxYear)))}))}get selectedEditCollection(){var e=null;return this.collections.has(this.selectedEditCollectionId)&&(e=this.collections.get(this.selectedEditCollectionId)),e}get selectedRunCollection(){var e=null;return this.collections.has(this.selectedRunCollectionId)&&(e=this.collections.get(this.selectedRunCollectionId)),e}get defaultEditCollectionSelected(){return"DEFAULT"===this.selectedEditCollection.name.toUpperCase()}get collectionsArray(){return(0,qt.VO)(this.collections)}get collectionsNames(){return this.collectionsArray.map((e=>e.name))}}class Ea{constructor(e){this.parentMgr=null,this.timeIntCollMgr=null,this.modelsParamFile=null,this.modelsParamFileName="",this.modelsParamFileContent=null,this.minYear=1980,this.maxYear=2016,this.minFitPos=1979,this.maxFitPos=1979,this.minFitCD4=1984,this.maxFitCD4=2016,this.minFitAIDS=1980,this.maxFitAIDS=1995,this.minFitHIVAIDS=1996,this.maxFitHIVAIDS=2016,this.fullData=!0,this.knotsCount=4,this.startIncZero=!0,this.maxIncCorr=!0,this.distributionFit="POISSON",this.delta4Fac=0,this.country="OTHER",this.rDisp=50,this.splineType="B-SPLINE",this.bootstrapCount=100,this.bootstrapType="NON-PARAMETRIC",this.modelsRunProgress=null,this.modelsRunLog=null,this.bootstrapRunProgress=null,this.bootstrapRunLog=null,this.setModelsParamFile=e=>{var t,a;e&&(this.modelsParamFile=e,this.modelsParamFileName=e.name,(t=this.modelsParamFile,a=new FileReader,new Promise(((e,r)=>{a.onload=t=>{e(t.target.result)},a.onerror=r,a.readAsText(t)}))).then((0,qt.aD)("success",(e=>this.modelsParamFileContent=e)),(0,qt.aD)("error",(e=>console.log(e)))))},this.setModelsParamFileName=e=>this.modelsParamFileName=e,this.setMinYear=e=>this.minYear=e,this.setMaxYear=e=>this.maxYear=e,this.setMinFitPos=e=>this.minFitPos=e,this.setMaxFitPos=e=>this.maxFitPos=e,this.setMinFitCD4=e=>this.minFitCD4=e,this.setMaxFitCD4=e=>this.maxFitCD4=e,this.setMinFitAIDS=e=>this.minFitAIDS=e,this.setMaxFitAIDS=e=>this.maxFitAIDS=e,this.setMinFitHIVAIDS=e=>this.minFitHIVAIDS=e,this.setMaxFitHIVAIDS=e=>this.maxFitHIVAIDS=e,this.setFullData=e=>this.fullData=e,this.setKnotsCount=e=>this.knotsCount=e,this.setStartIncZero=e=>this.startIncZero=e,this.setMaxIncCorr=e=>this.maxIncCorr=e,this.setDistributionFit=e=>this.distributionFit=e,this.setDelta4Fac=e=>this.delta4Fac=e,this.setCountry=e=>this.country=e,this.setRDisp=e=>this.rDisp=e,this.setSplineType=e=>this.splineType=e,this.setBootstrapCount=e=>this.bootstrapCount=e,this.setBootstrapType=e=>this.bootstrapType=e,this.setModelsRunProgress=e=>this.modelsRunProgress=e,this.setModelsRunLog=e=>this.modelsRunLog=e,this.runModels=()=>this.parentMgr.btnClicked("runModelBtn:HIVModelParams",{minYear:this.minYear,maxYear:this.maxYear,minFitPos:this.minFitPos,maxFitPos:this.maxFitPos,minFitCD4:this.minFitCD4,maxFitCD4:this.maxFitCD4,minFitAIDS:this.minFitAIDS,maxFitAIDS:this.maxFitAIDS,minFitHIVAIDS:this.minFitHIVAIDS,maxFitHIVAIDS:this.maxFitHIVAIDS,fullData:this.fullData,knotsCount:this.knotsCount,startIncZero:this.startIncZero,maxIncCorr:this.maxIncCorr,distributionFit:this.distributionFit,delta4Fac:this.delta4Fac,country:this.country,rDisp:this.rDisp,splineType:this.splineType,timeIntervals:this.timeIntCollMgr.selectedRunCollection.intervals,popCombination:this.parentMgr.popCombMgr.selectedCombination}),this.cancelModels=()=>this.parentMgr.btnClicked("cancelModelBtn"),this.setBootstrapRunProgress=e=>this.bootstrapRunProgress=e,this.setBootstrapRunLog=e=>this.bootstrapRunLog=e,this.runBootstrap=()=>this.parentMgr.btnClicked("runBootstrapBtn",{count:this.bootstrapCount,type:this.bootstrapType}),this.cancelBootstrap=()=>this.parentMgr.btnClicked("cancelBootstrapBtn"),this.parentMgr=e,this.timeIntCollMgr=new ha(this),(0,qt.rC)(this,{modelsParamFile:qt.LO,modelsParamFileName:qt.LO,modelsParamFileContent:qt.LO,minYear:qt.LO,maxYear:qt.LO,minFitPos:qt.LO,maxFitPos:qt.LO,minFitCD4:qt.LO,maxFitCD4:qt.LO,minFitAIDS:qt.LO,maxFitAIDS:qt.LO,minFitHIVAIDS:qt.LO,maxFitHIVAIDS:qt.LO,country:qt.LO,knotsCount:qt.LO,startIncZero:qt.LO,distributionFit:qt.LO,rDisp:qt.LO,delta4Fac:qt.LO,maxIncCorr:qt.LO,splineType:qt.LO,fullData:qt.LO,modelsRunProgress:qt.LO,modelsRunLog:qt.LO,bootstrapRunProgress:qt.LO,bootstrapRunLog:qt.LO,bootstrapCount:qt.LO,bootstrapType:qt.LO,setModelsParamFile:qt.aD,setModelsParamFileName:qt.aD,setMinYear:qt.aD,setMaxYear:qt.aD,setMinFitPos:qt.aD,setMaxFitPos:qt.aD,setMinFitCD4:qt.aD,setMaxFitCD4:qt.aD,setMinFitAIDS:qt.aD,setMaxFitAIDS:qt.aD,setMinFitHIVAIDS:qt.aD,setMaxFitHIVAIDS:qt.aD,setFullData:qt.aD,setKnotsCount:qt.aD,setStartIncZero:qt.aD,setMaxIncCorr:qt.aD,setDistributionFit:qt.aD,setDelta4Fac:qt.aD,setCountry:qt.aD,setRDisp:qt.aD,setSplineType:qt.aD,setBootstrapCount:qt.aD,setBootstrapType:qt.aD,runModels:qt.aD,cancelModels:qt.aD,setModelsRunProgress:qt.aD,setModelsRunLog:qt.aD,runBootstrap:qt.aD,cancelBootstrap:qt.aD,modelsRunInProgress:qt.Fl}),(0,qt.EH)((()=>{this.parentMgr.inputValueSet("xmlModel",this.modelsParamFileContent)})),(0,qt.EH)((()=>{this.timeIntCollMgr.setMinYear(this.minYear)})),(0,qt.EH)((()=>{this.timeIntCollMgr.setMaxYear(this.maxYear)}))}get modelsRunInProgress(){return null!==this.modelsRunProgress}}class ya{constructor(e){this.rootMgr=null,this.report=null,this.adjustReportParams={reportingDelay:!0,smoothing:!1,cd4ConfInt:!1},this.creatingReportInProgress=!1,this.setReport=e=>this.report=e,this.setAdjustReportReportingDelay=e=>this.adjustReportParams.reportingDelay=e,this.setAdjustReportSmoothing=e=>this.adjustReportParams.smoothing=e,this.setAdjustReportCD4ConfInt=e=>this.adjustReportParams.cd4ConfInt=e,this.setCreatingReportInProgress=e=>this.creatingReportInProgress=e,this.createReport=()=>{this.rootMgr.btnClicked("createReportBtn",Object.assign({name:"Main Report"},this.adjustReportParams))},this.cancelCreatingReport=()=>this.rootMgr.btnClicked("cancelCreatingReportBtn"),this.restoreDefaults=()=>{this.adjustReportParams={reportingDelay:!0,smoothing:!1,cd4ConfInt:!1}},this.rootMgr=e,(0,qt.rC)(this,{report:qt.LO,adjustReportParams:qt.LO,creatingReportInProgress:qt.LO,setReport:qt.aD,setAdjustReportReportingDelay:qt.aD,setAdjustReportSmoothing:qt.aD,setAdjustReportCD4ConfInt:qt.aD,restoreDefaults:qt.aD,createReport:qt.aD,cancelCreatingReport:qt.aD,setCreatingReportInProgress:qt.aD})}}(0,qt.jQ)({enforceActions:"observed",computedRequiresReaction:!0}),window.jQuery=l(),window.$=l();var Ma=new class{constructor(){var e=this;this.uiStateMgr=null,this.notificationsMgr=null,this.attrMappingMgr=null,this.origGroupMgr=null,this.caseBasedDataMgr=null,this.aggrDataMgr=null,this.summaryDataMgr=null,this.adjustMgr=null,this.popMgr=null,this.popCombMgr=null,this.modelMgr=null,this.reportMgr=null,this.shinyState="DISCONNECTED",this.shinyMessage={},this.onShinyEvent=e=>{switch(console.log("onShinyEvent",e),e.type){case"COMPLETED_STEPS_SET":"SUCCESS"===e.payload.ActionStatus&&this.uiStateMgr.setCompletedSteps(e.payload.CompletedSteps);break;case"CASE_BASED_DATA_UPLOADED":this.caseBasedDataMgr.setActionStatus(e.payload.ActionStatus),this.caseBasedDataMgr.setActionMessage(e.payload.ActionMessage),"SUCCESS"===e.payload.ActionStatus&&(this.caseBasedDataMgr.setFileName(e.payload.FileName),this.caseBasedDataMgr.setFilePath(e.payload.FilePath),this.caseBasedDataMgr.setFileSize(e.payload.FileSize),this.caseBasedDataMgr.setFileType(e.payload.FileType),this.uiStateMgr.setLastEventType(e.type));break;case"CASE_BASED_DATA_READ":this.caseBasedDataMgr.setActionStatus(e.payload.ActionStatus),this.caseBasedDataMgr.setActionMessage(e.payload.ActionMessage),"SUCCESS"===e.payload.ActionStatus&&(this.caseBasedDataMgr.setColumnNames(e.payload.ColumnNames),this.caseBasedDataMgr.setRecordCount(e.payload.RecordCount),this.attrMappingMgr.setMapping(e.payload.AttrMapping),this.summaryDataMgr.reset(),this.notificationsMgr.setMsg("Case-based data uploaded"),this.uiStateMgr.setLastEventType(e.type));break;case"CASE_BASED_ATTRIBUTE_MAPPING_APPLY_START":"SUCCESS"===e.payload.ActionStatus&&this.notificationsMgr.setMsg("Applying attribute mapping");break;case"CASE_BASED_ATTRIBUTE_MAPPING_APPLY_END":this.attrMappingMgr.setActionStatus(e.payload.ActionStatus),this.attrMappingMgr.setActionMessage(e.payload.ActionMessage),"SUCCESS"===e.payload.ActionStatus?(this.origGroupMgr.setDistribution(e.payload.OriginDistribution),this.origGroupMgr.setType(e.payload.OriginGroupingType),this.origGroupMgr.setGroupings(e.payload.OriginGrouping),this.notificationsMgr.setMsg("Attribute mapping has been applied"),this.summaryDataMgr.reset(),this.uiStateMgr.setLastEventType(e.type)):(this.notificationsMgr.setMsg("Attribute mapping could not be applied"),this.uiStateMgr.setLastEventType("CASE_BASED_DATA_READ"));break;case"CASE_BASED_DATA_ORIGIN_GROUPING_PREPARED":"SUCCESS"===e.payload.ActionStatus?(this.origGroupMgr.setType(e.payload.OriginGroupingType),this.origGroupMgr.setGroupings(e.payload.OriginGrouping)):this.notificationsMgr.setMsg("There was a problem with setting this origin grouping");break;case"CASE_BASED_DATA_ORIGIN_GROUPING_APPLIED":this.origGroupMgr.setActionStatus(e.payload.ActionStatus),this.origGroupMgr.setActionMessage(e.payload.ActionMessage),"SUCCESS"===e.payload.ActionStatus?(this.summaryDataMgr.reset(),this.summaryDataMgr.setDiagYearPlotData(e.payload.Summary.DiagYearPlotData),this.summaryDataMgr.setNotifQuarterPlotData(e.payload.Summary.NotifQuarterPlotData),this.adjustMgr.setRDWithoutStartYear(e.payload.Summary.DiagYearPlotData.filter.scaleMinYear),this.adjustMgr.setRDWithoutEndYear(Math.round(e.payload.Summary.NotifQuarterPlotData.filter.scaleMaxYear)),this.adjustMgr.setRDWithoutEndQrt(ze(e.payload.Summary.NotifQuarterPlotData.filter.scaleMaxYear)),this.adjustMgr.setRDWithStartYear(e.payload.Summary.DiagYearPlotData.filter.scaleMinYear),this.adjustMgr.setRDWithEndYear(Math.round(e.payload.Summary.NotifQuarterPlotData.filter.scaleMaxYear)),this.adjustMgr.setRDWithEndQrt(ze(e.payload.Summary.NotifQuarterPlotData.filter.scaleMaxYear)),this.adjustMgr.setDataBounds({startYear:e.payload.Summary.DiagYearPlotData.filter.scaleMinYear,endYear:Math.round(e.payload.Summary.NotifQuarterPlotData.filter.scaleMaxYear),endQrt:ze(e.payload.Summary.NotifQuarterPlotData.filter.scaleMaxYear)}),this.uiStateMgr.setLastEventType(e.type)):this.uiStateMgr.setLastEventType("CASE_BASED_ATTRIBUTE_MAPPING_APPLY_END"),this.notificationsMgr.setMsg(e.payload.ActionMessage);break;case"CASE_BASED_SUMMARY_DATA_PREPARED":"SUCCESS"===e.payload.ActionStatus?(this.summaryDataMgr.setSelectedCount(e.payload.Summary.SelectedCount),this.summaryDataMgr.setTotalCount(e.payload.Summary.TotalCount),this.summaryDataMgr.setMissPlotData(e.payload.Summary.MissPlotData),this.summaryDataMgr.setRepDelPlotData(e.payload.Summary.RepDelPlotData)):this.notificationsMgr.setMsg(e.payload.ActionMessage);break;case"ADJUSTMENTS_RUN_STARTED":"SUCCESS"===e.payload.ActionStatus&&(this.adjustMgr.setAdjustmentsRunProgress(1),this.adjustMgr.setAdjustmentsReport(null));break;case"ADJUSTMENTS_RUN_LOG_SET":"SUCCESS"===e.payload.ActionStatus&&this.adjustMgr.setAdjustmentsRunLog(e.payload.RunLog);break;case"ADJUSTMENTS_RUN_FINISHED":this.adjustMgr.setAdjustmentsRunProgress(null),"SUCCESS"===e.payload.ActionStatus?(this.uiStateMgr.setLastEventType(e.type),this.adjustMgr.setAdjustmentsReport(e.payload.AdjustmentsReport),this.notificationsMgr.setMsg("Adjustment run finished")):this.notificationsMgr.setMsg("Adjustment run failed");break;case"ADJUSTMENTS_RUN_CANCELLED":this.adjustMgr.setAdjustmentsRunProgress(null),"SUCCESS"===e.payload.ActionStatus&&this.notificationsMgr.setMsg("Adjustment run cancelled");break;case"CREATING_REPORT_STARTED":"SUCCESS"===e.payload.ActionStatus&&(this.reportMgr.setCreatingReportInProgress(!0),this.notificationsMgr.setMsg("Creating report started"));break;case"CREATING_REPORT_FINISHED":"SUCCESS"===e.payload.ActionStatus&&(this.uiStateMgr.setLastEventType(e.type),this.reportMgr.setReport(e.payload.Report),this.reportMgr.setCreatingReportInProgress(!1),this.notificationsMgr.setMsg("Creating report finished"));break;case"AGGR_DATA_UPLOADED":this.aggrDataMgr.setActionStatus(e.payload.ActionStatus),this.aggrDataMgr.setActionMessage(e.payload.ActionMessage),"SUCCESS"===e.payload.ActionStatus&&(this.aggrDataMgr.setFileName(e.payload.FileName),this.aggrDataMgr.setFilePath(e.payload.FilePath),this.aggrDataMgr.setFileSize(e.payload.FileSize),this.aggrDataMgr.setFileType(e.payload.FileType));break;case"AGGR_DATA_READ":this.aggrDataMgr.setActionStatus(e.payload.ActionStatus),this.aggrDataMgr.setActionMessage(e.payload.ActionMessage),"SUCCESS"===e.payload.ActionStatus&&(this.aggrDataMgr.setDataFiles(e.payload.DataFiles),this.aggrDataMgr.setPopulationNames(e.payload.PopulationNames),this.notificationsMgr.setMsg("Aggregated data uploaded"));break;case"AVAILABLE_STRATA_SET":console.log(e.payload.AvailableVariables),"SUCCESS"===e.payload.ActionStatus&&(this.popMgr.setAvailableVariables(e.payload.AvailableVariables),this.popMgr.setAvailableStrata(e.payload.AvailableStrata))}},this.setShinyState=e=>{this.shinyState=e,"SESSION_INITIALIZED"===e&&Shiny.addCustomMessageHandler("shinyHandler",this.onShinyEvent)},this.btnClicked=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!ee(window.Shiny)&&e.shinyReady?Shiny.setInputValue(t,a,{priority:"event"}):console.log("btnClicked: Shiny is not available",t,(0,qt.ZN)(a))},this.inputValueSet=(e,t)=>{!ee(window.Shiny)&&this.shinyReady?Shiny.setInputValue(e,t):console.log("inputValueSet: Shiny is not available",e,(0,qt.ZN)(t))},this.setShinyMessage=e=>{this.shinyMessage=e},this.unbindShiny=e=>{!ee(window.Shiny)&&this.shinyReady?(window.Shiny.unbindAll(),Kt(e).forEach((e=>delete window.Shiny.shinyapp.$bindings[e]))):console.log("unbindShinyInputs: Shiny is not available")},this.bindShiny=()=>{!ee(window.Shiny)&&this.shinyReady?window.Shiny.bindAll():console.log("bindShinyInputs: Shiny is not available")},this.uiStateMgr=new Xt(this),this.notificationsMgr=new ta(this),this.caseBasedDataMgr=new la(this),this.aggrDataMgr=new oa(this),this.attrMappingMgr=new aa(this),this.origGroupMgr=new na(this),this.summaryDataMgr=new ma(this),this.adjustMgr=new ca(this),this.popMgr=new da(this),this.popCombMgr=new ga(this),this.modelMgr=new Ea(this),this.reportMgr=new ya(this),(0,qt.rC)(this,{shinyState:qt.LO,shinyMessage:qt.LO,shinyReady:qt.Fl,jsonShinyMessage:qt.Fl,setShinyState:qt.aD,btnClicked:qt.aD,inputValueSet:qt.aD,setShinyMessage:qt.aD,unbindShiny:qt.aD,bindShiny:qt.aD})}get shinyReady(){return"SESSION_INITIALIZED"===this.shinyState||"DEBUGGING"===this.shinyState}get jsonShinyMessage(){return JSON.stringify(this.shinyMessage)}get shinyStateHuman(){var e="";switch(this.shinyState){case"DISCONNECTED":e="DISCONNECTED";break;case"CONNECTED":e="INITIALIZING";break;case"DEBUGGING":case"SESSION_INITIALIZED":e="READY"}return e}};n.render(r.createElement(i.zt,{appMgr:Ma},r.createElement(Jt,null)),document.getElementById("app"),(()=>{console.log("ReactDOM.render complete"),l()((()=>{l()(document).on("shiny:disconnected",(()=>Ma.setShinyState("DISCONNECTED"))),l()(document).on("shiny:connected",(()=>Ma.setShinyState("CONNECTED"))),l()(document).on("shiny:sessioninitialized",(()=>Ma.setShinyState("SESSION_INITIALIZED"))),l()(document).on("shiny:message",(e=>Ma.setShinyMessage(e))),l()(document).on("shiny:inputchanged",(e=>console.log("shiny:inputchanged:",e))),l()(document).on("shiny:filedownload",(e=>console.log("shiny:filedownload:",e)))}))}))}},t={};function a(r){if(t[r])return t[r].exports;var n=t[r]={id:r,loaded:!1,exports:{}};return e[r](n,n.exports,a),n.loaded=!0,n.exports}a.m=e,a.x=e=>{},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={179:0},t=[[9606,216]],r=e=>{},n=(n,i)=>{for(var s,l,[o,m,c,d]=i,u=0,g=[];u<o.length;u++)l=o[u],a.o(e,l)&&e[l]&&g.push(e[l][0]),e[l]=0;for(s in m)a.o(m,s)&&(a.m[s]=m[s]);for(c&&c(a),n&&n(i);g.length;)g.shift()();return d&&t.push.apply(t,d),r()},i=self.webpackChunkhiv_estimates_accuracy=self.webpackChunkhiv_estimates_accuracy||[];function s(){for(var r,n=0;n<t.length;n++){for(var i=t[n],s=!0,l=1;l<i.length;l++){var o=i[l];0!==e[o]&&(s=!1)}s&&(t.splice(n--,1),r=a(a.s=i[0]))}return 0===t.length&&(a.x(),a.x=e=>{}),r}i.forEach(n.bind(null,0)),i.push=n.bind(null,i.push.bind(i));var l=a.x;a.x=()=>(a.x=l||(e=>{}),(r=s)())})(),a.x()})();